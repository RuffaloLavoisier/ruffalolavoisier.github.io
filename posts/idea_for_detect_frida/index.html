<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Frida íƒì§€ ë°©ë²•ì— ëŒ€í•œ ê³ ì°°" /><meta property="og:locale" content="en" /><meta name="description" content="Frida íƒì§€ì™€ ìš°íšŒ ê·¸ë¦¬ê³  íƒì§€ ìš°íšŒì™€ ìš°íšŒ íƒì§€" /><meta property="og:description" content="Frida íƒì§€ì™€ ìš°íšŒ ê·¸ë¦¬ê³  íƒì§€ ìš°íšŒì™€ ìš°íšŒ íƒì§€" /><link rel="canonical" href="https://ruffalolavoisier.github.io/posts/idea_for_detect_frida/" /><meta property="og:url" content="https://ruffalolavoisier.github.io/posts/idea_for_detect_frida/" /><meta property="og:site_name" content="Unforgettable" /><meta property="og:image" content="https://ruffalolavoisier.github.io/assets/img/common/cat_mouse_game.png" /><meta property="og:image:alt" content="Cat and Mouse Game" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-03-14T03:58:13+09:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://ruffalolavoisier.github.io/assets/img/common/cat_mouse_game.png" /><meta name="twitter:image:alt" content="Cat and Mouse Game" /><meta property="twitter:title" content="Frida íƒì§€ ë°©ë²•ì— ëŒ€í•œ ê³ ì°°" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-03-22T02:04:48+09:00","datePublished":"2025-03-14T03:58:13+09:00","description":"Frida íƒì§€ì™€ ìš°íšŒ ê·¸ë¦¬ê³  íƒì§€ ìš°íšŒì™€ ìš°íšŒ íƒì§€","headline":"Frida íƒì§€ ë°©ë²•ì— ëŒ€í•œ ê³ ì°°","image":{"lqip":"data:image/webp;base64","alt":"Cat and Mouse Game","url":"https://ruffalolavoisier.github.io/assets/img/common/cat_mouse_game.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ruffalolavoisier.github.io/posts/idea_for_detect_frida/"},"url":"https://ruffalolavoisier.github.io/posts/idea_for_detect_frida/"}</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2677268060283942" crossorigin="anonymous"></script><title>Frida íƒì§€ ë°©ë²•ì— ëŒ€í•œ ê³ ì°° | Unforgettable</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Unforgettable"><meta name="application-name" content="Unforgettable"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js,npm/mermaid@11.4.0/dist/mermaid.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script> <script>mermaid.initialize({startOnLoad:true});</script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="https://ruffalolavoisier.github.io/assets/img/profile.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Unforgettable</a><p class="site-subtitle fst-italic mb-0">I wonder Why I wonder</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/project/" class="nav-link"> <i class="fa-fw fas fa-laptop-code"></i> <span>PROJECT</span> </a><li class="nav-item"> <a href="/interest/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>INTEREST</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/RuffaloLavoisier" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['RuffaloLavoisier','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://stackoverflow.com/users/17522538/ruffalo" aria-label="stack-overflow" target="_blank" rel="noopener noreferrer" > <i class="fab fa-stack-overflow"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Frida íƒì§€ ë°©ë²•ì— ëŒ€í•œ ê³ ì°°</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip><b>Frida íƒì§€ ë°©ë²•ì— ëŒ€í•œ ê³ ì°°</b></h1><i></i><p class="post-desc fw-light mb-4">Frida íƒì§€ì™€ ìš°íšŒ ê·¸ë¦¬ê³  íƒì§€ ìš°íšŒì™€ ìš°íšŒ íƒì§€</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1741892293" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Mar 14, 2025 </time> </span> <span> Updated <time data-ts="1742576688" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Mar 22, 2025 </time> </span><div class="mt-3 mb-3"> <a href="https://ruffalolavoisier.github.io/assets/img/common/cat_mouse_game.png" class="popup img-link preview-img blur"><img data-src="https://ruffalolavoisier.github.io/assets/img/common/cat_mouse_game.png" alt="Cat and Mouse Game" width="1200" height="630" data-lqip="true" src="data:image/webp;base64"></a><figcaption class="text-center pt-2 pb-2">Cat and Mouse Game</figcaption></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/RuffaloLavoisier">Ruffalo</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="3489 words" > <em>19 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Frida íƒì§€ ë°©ë²•ì— ëŒ€í•œ ê³ ì°°</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Frida íƒì§€ ë°©ë²•ì— ëŒ€í•œ ê³ ì°°</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><h2 id="introduction"><span class="me-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>ì¼ë°˜ì ìœ¼ë¡œ ì•ˆë“œë¡œì´ë“œ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì´ìš©í•˜ë©´ ì•±ì€ ì‹¤í–‰ ì‹œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¡œë“œí•˜ì—¬ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. ì´ëŠ” ì•ˆë“œë¡œì´ë“œì—ì„œ ì •í•´ ë†“ì€ ì‹œìŠ¤í…œ íŒŒí‹°ì…˜ì´ë‚˜ ì•±ê³¼ í•¨ê»˜ ì œê³µë˜ëŠ” ë””ë ‰í„°ë¦¬ ê²½ë¡œì—ì„œë§Œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°€ì ¸ì™€ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.</p><p>ì•„ë˜ì™€ ê°™ì´ ì •í•´ì§„ ì•±ì˜ ì†ŒìŠ¤ ë””ë ‰í„°ë¦¬ì—ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¡œë“œí•  ìˆ˜ ìˆë‹¤.</p><div class="language-shell nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Loading library : /data/app/~~p-vfdsffewfewg<span class="o">==</span>/com.ruffalo.test-dQ8dewfeffewfef8qA<span class="o">==</span>/lib/arm64/libnative-lib.so
</pre></table></code></div></div><p>í—ˆê°€ë˜ì§€ ì•Šì€ í˜¹ì€ ì•ˆë“œë¡œì´ë“œ ì •ì±…ì— ë°˜í•˜ëŠ” ìœ„ì¹˜ì— ìˆëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ <code class="language-plaintext highlighter-rouge">/proc/self/maps</code> ì—ì„œ ì˜¬ë¼ì˜¤ë©´ í•´ë‹¹ ë””ë°”ì´ìŠ¤ í™˜ê²½ì€ ë¹„ì •ìƒ í˜¹ì€ ìœ„í˜‘ìœ¼ë¡œ íŒë‹¨í•˜ê³ ì„œ ì•±ì˜ ì‹¤í–‰ì„ ê±°ë¶€í•˜ê±°ë‚˜ ì¤‘ë‹¨í•˜ì—¬ì•¼ í•œë‹¤.</p><p>ì´ì™€ ê°™ì€ í™˜ê²½ê³¼ í–‰ë™ë“¤ì€ ìœ„í˜‘ íƒì§€ë¶€í„° ì‹œì‘í•˜ì—¬ ìœ„í˜‘ íƒì§€ ìš°íšŒ ê·¸ë¦¬ê³  ìœ„í˜‘ ìš°íšŒ íƒì§€ë¼ëŠ” ëì—†ëŠ” ì‹¸ì›€ì— ë°©ì•„ì‡ ê°€ ë˜ì—ˆë‹¤.</p><p>ê·¸ëŸ¬í•œ ê¸°ìˆ ë“¤ ì¤‘ í•˜ë‚˜ë¡œ ë£¨íŒ…ì´ ìˆëŠ”ë° ì´ëŠ” ëŒ€ì¤‘ì´ ë§ì´ ì‚¬ìš©í•˜ëŠ” Magisk ê°œë°œìê°€ ì´ì•¼ê¸°í•œ ê²ƒì²˜ëŸ¼ hide ë¼ëŠ” ê¸°ëŠ¥ì— ëì—†ëŠ” íŒ¨ì¹˜ê°€ ì´ì–´ì¡Œë‹¤ê³  ë§í•œë‹¤.</p><blockquote class="prompt-info"><p><strong>MagiskHide Removal</strong>; I have lost interest in fighting this battle for quite a while; plus, the existing MagiskHide implementation is flawed in so many ways. Decoupling Magisk from root hiding is, in my opinion, beneficial to the community. Ever since my announcement on Twitter months ago, highly effective â€œroot hidingâ€ modules (much MUCH better than MagiskHide) has been flourishing, which again shows that people are way more capable than I am on this subject. So why not give those determined their time to shine, and let me focus on improving Magisk instead of drowning in the everlasting cat-and-mouse game ğŸ˜‰.</p></blockquote><p>ë³¸ ê¸€ì—ì„œëŠ” ì—¬ëŸ¬ ì†ŒìŠ¤ì½”ë“œì™€ ì•ˆë“œë¡œì´ë“œ zygote ê°€ ì˜¬ë¼ì˜¤ê³  ì•±ì´ ëˆˆì— ë³´ì´ê¸°ê¹Œì§€ ë”°ë¼ê°€ë³´ë©´ì„œ ë³€í™”í•œ ë©”ëª¨ë¦¬ë¥¼ í†µí•´ ë¹„ì •ìƒ í™˜ê²½ì„ ê°ì§€í•˜ëŠ” ìµœì²¨ë‹¨ íƒì§€ ë©”ì»¤ë‹ˆì¦˜ì„ ì‚´í´ë³´ì•˜ë‹¤.</p><p>ê·¸ì¤‘ ë™ì  ë°”ì´ë„ˆë¦¬ ë¶„ì„ ë„êµ¬ì— ëŒ€í•œ íƒì§€ ì‹œì ê³¼ íƒì§€ ìš°íšŒ ê·¸ë¦¬ê³  ê·¸ê²ƒì„ í•œ ë²ˆ ë” ìš°íšŒ íƒì§€í•˜ëŠ” ê¸°ë²•ì„ ì‚¬ìš©í–ˆëŠ”ë° ì´ëŠ” ë§ˆì¹˜ ê³ ì–‘ì´ì™€ ì¥ì˜ ê²Œì„ì„ ì—°ìƒì‹œí‚¤ëŠ” ë¶€ë¶„ì´ ì—†ì§€ ì•Šì•„ ìˆì„ ê²ƒì´ë‹¤.</p><p>ì‹¤ì œ ìƒí™©ì„ ê°€ì •í•œë‹¤ë©´ ë¹„ì •ìƒ í™˜ê²½ì—ì„œ ì‚¬ìš©ì„ ë§‰ëŠ” ì•±ì´ ìˆë‹¤ê³  íˆì„ ë•Œ ë¹„ì •ìƒ ë‹¨ë§ì—ì„œ ì•±ì´ ì‹¤í–‰ ìƒíƒœì— ìˆì„ ë•Œ ì•±ì€ ì‚¬ìš©ì„ ì¤‘ë‹¨í•˜ë¼ê³  ì‚¬ìš©ìì—ê²Œ Alert ë¥¼ ë„ìš´ë‹¤.</p><p>ê·¸ëŸ¬ë‚˜ ëˆ„êµ°ê°€ëŠ” ê·¸ëŸ¼ì—ë„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ì´ë¥¼ ìš°íšŒí•˜ë ¤ê³  í•œë‹¤. ê·¸ëŸ¬ë‚˜ ë˜ ëˆ„êµ°ê°€ëŠ” ì´ë¥¼ ìš°íšŒí•  ê²½ìš°ë¥¼ ëŒ€ë¹„í•˜ì—¬ í•œ ë‹¨ê³„ ë” ê³ ë„í™”ëœ íƒì§€ ëŒ€ì±…ì„ ì„¸ìš°ê³  ìˆë‹¤.</p><p>ì´ëŸ¬í•œ ëë„ ì—†ëŠ” ê³µë°©ì „ì´ ì´ì–´ì§€ëŠ” ê²ƒì´ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.</p><h2 id="understanding-the-core-issue"><span class="me-2">Understanding the Core Issue</span><a href="#understanding-the-core-issue" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>ì•„ë˜ëŠ” í˜„ì¬ ê³µê°œëœ ëª‡ê°€ì§€ íƒì§€ ì•„ì´ë””ì–´ì— ëŒ€í•˜ì—¬ ì‚´í´ë³¸ ì¼€ì´ìŠ¤ì´ë©° ì‹¤ì œ ì†Œí”„íŠ¸ì›¨ì–´ì—ì„œë„ ì‚¬ìš©ë˜ëŠ” ë°©ë²•ì´ë‹¤.</p><p>ë³¸ ê¸€ì—ì„œëŠ” ìì²´ ê²€íŒŒì¼í•œ ë°”ì´ë„ˆë¦¬ë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤.</p><h3 id="ë©”ëª¨ë¦¬ë¥¼-í†µí•œ-íƒì§€"><span class="me-2">ë©”ëª¨ë¦¬ë¥¼ í†µí•œ íƒì§€</span><a href="#ë©”ëª¨ë¦¬ë¥¼-í†µí•œ-íƒì§€" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>ë¨¼ì € ë¹„ì •ìƒ í™˜ê²½ì´ ì¤€ë¹„ëœ ëª¨ë°”ì¼ì´ë‚˜ ê·¸ëŸ¬í•œ ì•±ì´ ì„¤ì¹˜ëœ ëª¨ë°”ì¼ì„ ì¤€ë¹„í•œë‹¤.</p><p>ê·¸ í›„ ëª¨ë°”ì¼ì—ì„œ íƒì§€ ë¡œì§ì´ ì ìš©ëœ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹œì‘í•œë‹¤.</p><p>ì´ë•Œ ì•±ì˜ pid ë¥¼ ì‚´í´ë³´ë©´ ì•„ë˜ì™€ ê°™ë‹¤.</p><p>í˜„ì¬ pid ëŠ” 20109 ì´ë‹¤.</p><div class="language-shell nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="o">{</span>
    <span class="s2">"arch"</span>: <span class="s2">"arm64"</span>,
    <span class="s2">"codeSigningPolicy"</span>: <span class="s2">"optional"</span>,
    <span class="s2">"id"</span>: 20109,
    <span class="s2">"pageSize"</span>: 4096,
    <span class="s2">"platform"</span>: <span class="s2">"linux"</span>,
    <span class="s2">"pointerSize"</span>: 8
<span class="o">}</span>
</pre></table></code></div></div><p>ë¡œì»¬ PC ì—ì„œ ëª¨ë°”ì¼ì— ë¦¬ëˆ…ìŠ¤ ì‰˜ì²˜ëŸ¼ ë¶™ì„ ìˆ˜ ìˆëŠ”ë° ì‰˜ë¡œ ë¨¼ì € ì ‘ê·¼í•œë‹¤.</p><div class="language-shell nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>x1q:/proc/20109 <span class="c"># cat maps | grep ruffalo                                                                           </span>
6d22b2c000-6d23555000 r--p 00000000 00:01 265762                         /memfd:ruffalo-agent-64.so <span class="o">(</span>deleted<span class="o">)</span>
6d23556000-6d2428d000 r-xp 00a29000 00:01 265762                         /memfd:ruffalo-agent-64.so <span class="o">(</span>deleted<span class="o">)</span>
6d2428d000-6d2435e000 r--p 0175f000 00:01 265762                         /memfd:ruffalo-agent-64.so <span class="o">(</span>deleted<span class="o">)</span>
6d2435f000-6d2437a000 rw-p 01830000 00:01 265762                         /memfd:ruffalo-agent-64.so <span class="o">(</span>deleted<span class="o">)</span>
x1q:/proc/20109 <span class="c">#</span>
</pre></table></code></div></div><p>ìœ„ì—ì„œ ë³¼ ìˆ˜ ìˆëŠ” ê²ƒì²˜ëŸ¼ <code class="language-plaintext highlighter-rouge">/proc/[pid]</code> ì— ì ‘ê·¼í•˜ì—¬ maps ë¥¼ ì‚´í´ë³´ë©´ í˜„ì¬ ë©”ëª¨ë¦¬ì— ì˜¬ë¼ì˜¨ Frida ë¥¼ ì‚´í´ë³¼ ìˆ˜ ìˆë‹¤.</p><p>ë³´í†µ ì´ëŸ¬í•œ ë¡œì§ì„ ì‘ì„±í•œë‹¤ê³  í•˜ë©´ ì•„ë˜ì™€ ê°™ì„ ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤.</p><p>ìƒí™©ì— ë”°ë¼ì„œ ë‹¤ë¥¼ ìˆ˜ ìˆì§€ë§Œ ì´í•´ë¥¼ ìœ„í•˜ì—¬ ê°„ë‹¨í•˜ê²Œ ì‘ì„±í•´ë³¸ë‹¤.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kt">char</span><span class="o">*</span> <span class="n">p_result</span> <span class="o">=</span> <span class="n">strstr</span><span class="p">(</span><span class="n">readline_from_maps</span><span class="p">,</span> <span class="s">"/memfd:ruffalo-agent-64.so"</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">NULL</span> <span class="o">!=</span> <span class="n">p_result</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Detected</span>
  <span class="n">__android_log_print</span><span class="p">(</span><span class="n">ANDROID_LOG_VERBOSE</span><span class="p">,</span> <span class="s">"Sample-Test"</span><span class="p">,</span> <span class="s">"Found"</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>strstr í•¨ìˆ˜ëŠ” ì•„ë˜ì™€ ê°™ì€ ì¸ìë¥¼ ë°›ê³  ë°˜í™˜ì„ í•œë‹¤.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kt">char</span><span class="o">*</span> <span class="n">strstr</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">string1</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">string2</span><span class="p">)</span>
</pre></table></code></div></div><p>string2 ë¬¸ìì—´ì´ string1 ì— ì¡´ì¬í•œë‹¤ë©´ string2 ë¬¸ìì—´ì„ ë°˜í™˜í•˜ë©° ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ 0 ì„ ë°˜í™˜í•œë‹¤.</p><p>ë”°ë¼ì„œ maps ì—ì„œ ì½ì€ ë¬¸ìì—´ì— íƒì§€í•˜ë ¤ëŠ” ë¬¸ìì—´ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒì´ë‹¤.</p><h3 id="ë©”ëª¨ë¦¬-íƒì§€-ìš°íšŒ"><span class="me-2">ë©”ëª¨ë¦¬ íƒì§€ ìš°íšŒ</span><a href="#ë©”ëª¨ë¦¬-íƒì§€-ìš°íšŒ" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>ì´ë¥¼ ìš°íšŒí•˜ëŠ” ê±¸ ë´ë³´ê°°ë‹¤.</p><p><code class="language-plaintext highlighter-rouge">/proc/[pid]/maps</code> ì— ì˜¬ë¼ì˜¨ agent ë¥¼ íƒì§€í•˜ì˜€ëŠ”ë° ì´ë¥¼ ìš°íšŒí•œë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì„ ê²ƒì´ë‹¤.</p><p>ì‹¤ì œë¼ë©´ ë¡œì§ì„ ë³´í˜¸í•˜ê¸° ìœ„í•˜ì—¬ ê³ ë‚œë„ì˜ ë‚œë…í™”ì™€ ì•”í˜¸í™” ê·¸ë¦¬ê³  ëŸ°íƒ€ì„ íƒì§€ë¡œ ë¡œì§ì„ ë“¤ì—¬ë‹¤ë³´ê¸° í˜ë“¤í…ë° í˜„ì¬ëŠ” ì´ ê³¼ì •ì„ ë‹¤ ìš°íšŒí–ˆë‹¤ê³  ê°€ì •í•œë‹¤.</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="nx">Interceptor</span><span class="p">.</span><span class="nf">attach</span><span class="p">(</span><span class="nx">Module</span><span class="p">.</span><span class="nf">getExportByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">libc.so</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">strstr</span><span class="dl">'</span><span class="p">),</span> <span class="p">{</span>
    <span class="na">onEnter</span><span class="p">:</span> <span class="nf">function </span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">str1</span> <span class="o">=</span> <span class="nx">Memory</span><span class="p">.</span><span class="nf">readCString</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
        <span class="kd">var</span> <span class="nx">str2</span> <span class="o">=</span> <span class="nx">Memory</span><span class="p">.</span><span class="nf">readCString</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">str2</span><span class="p">.</span><span class="nf">indexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">/memfd:ruffalo-agent-64.so</span><span class="dl">"</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
            <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">str1:%s str2:%s</span><span class="se">\n</span><span class="dl">"</span><span class="p">,</span> <span class="nx">str1</span><span class="p">,</span> <span class="nx">str2</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">hook</span><span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">},</span>        
    <span class="na">onLeave</span><span class="p">:</span> <span class="nf">function </span><span class="p">(</span><span class="nx">retval</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hook</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">retval</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="mh">0x0</span><span class="p">);</span>
            <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Replace ret value to 0</span><span class="dl">"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></table></code></div></div><p>ìœ„ì™€ ê°™ì´ ìš°íšŒ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆëŠ”ë° strstr í•¨ìˆ˜ ë°˜í™˜ê°’ì„ ì¡°ì‘í•  ìˆ˜ ìˆë‹¤.</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nx">str2</span><span class="p">.</span><span class="nf">indexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">string</span><span class="dl">"</span><span class="p">)</span>
</pre></table></code></div></div><p>í•´ë‹¹ í•¨ìˆ˜ëŠ” <code class="language-plaintext highlighter-rouge">str2</code> ë¬¸ìì—´ ì•ˆì— <code class="language-plaintext highlighter-rouge">string</code> ì´ ìˆë‹¤ë©´ ì‹œì‘í•˜ëŠ” ê·¸ ë¬¸ìì—´ì˜ ì¸ë±ìŠ¤ ë²ˆí˜¸ë¥¼ ë°˜í™˜í•˜ê³  ì—†ìœ¼ë©´ <code class="language-plaintext highlighter-rouge">-1</code> ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤.</p><p>ì¦‰ íŠ¹ì • ë¬¸ìì—´ì„ ë°œê²¬í•˜ë©´ strstr ë°˜í™˜ê°’ì„ 0 ìœ¼ë¡œ ë³€ì¡°í•˜ëŠ” ê²ƒì´ë‹¤.</p><blockquote class="prompt-info"><p><code class="language-plaintext highlighter-rouge">strstr(str1, str2)</code> ë°˜í™˜ê°’ 0 ì´ ì˜ë¯¸í•˜ëŠ” ê²ƒì€ str1 ì•ˆì— str2 ì´ ì—†ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.</p></blockquote><h3 id="ì‹¤í–‰ì¤‘ì¸-í”„ë¡œì„¸ìŠ¤-íƒì§€ë¥¼-í†µí•œ-ìš°íšŒ-íƒì§€"><span class="me-2">ì‹¤í–‰ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ íƒì§€ë¥¼ í†µí•œ ìš°íšŒ íƒì§€</span><a href="#ì‹¤í–‰ì¤‘ì¸-í”„ë¡œì„¸ìŠ¤-íƒì§€ë¥¼-í†µí•œ-ìš°íšŒ-íƒì§€" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>ì•ì—ì„œ ë©”ëª¨ë¦¬ë¥¼ í†µí•œ íƒì§€ë¥¼ ì§„í–‰í–ˆëŠ”ë° íŠ¹ì • ë¬¸ìì—´ì¼ ë•Œ ë°˜í™˜ê°’ì„ ë³€ì¡°í•˜ì—¬ ìš°íšŒí•œ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.</p><p>ê·¸ëŸ¼ ì´ë²ˆì—ëŠ” ì´ì— ëŒ€ì‘í•˜ì—¬ í”„ë¡œì„¸ìŠ¤ë¥¼ í†µí•œ íƒì§€ë¥¼ ì§„í–‰í•´ê² ë‹¤.</p><div class="language-shell nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>x1q:/proc/20109 <span class="c"># ps -ef | grep ruffalo                                                                                 </span>
root         21513 30531 19 02:29:32 /debug_ramdisk/.magisk/pts/1 00:00:00 <span class="nb">grep </span>ruffalo
root         24938     1 0 01:35:54 ?     00:05:36 ruffalo-server-16.6.3-android-arm64
root         24954     1 0 01:35:56 ?     00:00:00 10 unix:abstract<span class="o">=</span>/ruffalo-b8b5725d-57e7-4c20-b8f7-8e7573912b0d
x1q:/proc/20109 <span class="c">#</span>
</pre></table></code></div></div><p>ìœ„ í”„ë¡œì„¸ìŠ¤ íƒì§€ë„ ë¹„ìŠ·í•˜ê²Œ ì§„í–‰ í•  ìˆ˜ ìˆë‹¤.</p><p><code class="language-plaintext highlighter-rouge">ps</code> ëª…ë ¹ì–´ë¥¼ í†µí•´ í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ë“¤ì„ ë³¼ ìˆ˜ ìˆë‹¤.</p><p>ì•„ë˜ì™€ ê°™ì´ êµ¬í˜„í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kt">char</span><span class="o">*</span> <span class="n">p_result</span> <span class="o">=</span> <span class="n">strstr</span><span class="p">(</span><span class="n">readline_from_process</span><span class="p">,</span> <span class="s">"ruffalo-server-16.6.3-android-arm64"</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">NULL</span> <span class="o">!=</span> <span class="n">p_result</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Detected</span>
  <span class="n">__android_log_print</span><span class="p">(</span><span class="n">ANDROID_LOG_VERBOSE</span><span class="p">,</span> <span class="s">"Sample-Test"</span><span class="p">,</span> <span class="s">"Found"</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>process ë¥¼ í™•ì¸í•˜ëŠ” ëª…ë ¹ì–´ë¥¼ í†µí•´ í•´ë‹¹ ë¬¸ìì—´ì„ íŒŒì‹±í•˜ê³  íƒì§€í•˜ë ¤ëŠ” ë¬¸ìì—´ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒì´ë‹¤.</p><p>ìœ„ëŠ” ì˜ˆì‹œì´ë©° ì—¬ëŸ¬ ë°©ë²•ì´ ìˆê² ì§€ë§Œ ì‹¤ì œë¡  ì˜¤íƒì„ ì¤„ì´ê³  ì •íƒì„ ë†’ê²Œ êµ¬í˜„í•˜ëŠ” ê²Œ ì¤‘ìš”í•˜ë‹¤.</p><h3 id="ì‹¤í–‰ì¤‘ì¸-í”„ë¡œì„¸ìŠ¤-íƒì§€-ìš°íšŒ"><span class="me-2">ì‹¤í–‰ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ íƒì§€ ìš°íšŒ</span><a href="#ì‹¤í–‰ì¤‘ì¸-í”„ë¡œì„¸ìŠ¤-íƒì§€-ìš°íšŒ" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>process ë¥¼ í™•ì¸í•˜ê³  ì´ë•Œ ì‹¤í–‰ì¤‘ì¸ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ëŠ” ê²ƒì¸ë° ì´ë¥¼ ìš°íšŒí•œë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì„ ê²ƒì´ë‹¤.</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="nx">Interceptor</span><span class="p">.</span><span class="nf">attach</span><span class="p">(</span><span class="nx">Module</span><span class="p">.</span><span class="nf">getExportByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">libc.so</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">strstr</span><span class="dl">'</span><span class="p">),</span> <span class="p">{</span>
    <span class="na">onEnter</span><span class="p">:</span> <span class="nf">function </span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">str1</span> <span class="o">=</span> <span class="nx">Memory</span><span class="p">.</span><span class="nf">readCString</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
        <span class="kd">var</span> <span class="nx">str2</span> <span class="o">=</span> <span class="nx">Memory</span><span class="p">.</span><span class="nf">readCString</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">str2</span><span class="p">.</span><span class="nf">indexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">ruffalo-server-16.6.3-android-arm64</span><span class="dl">"</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
            <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">str1:%s str2:%s</span><span class="se">\n</span><span class="dl">"</span><span class="p">,</span> <span class="nx">str1</span><span class="p">,</span> <span class="nx">str2</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">hook</span><span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">},</span>        
    <span class="na">onLeave</span><span class="p">:</span> <span class="nf">function </span><span class="p">(</span><span class="nx">retval</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hook</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">retval</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="mh">0x0</span><span class="p">);</span>
            <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Replace ret value to 0</span><span class="dl">"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></table></code></div></div><p>ì´ë„ ë™ì¼í•˜ê²Œ íŠ¹ì • ë¬¸ìì—´ì¸ì§€ í™•ì¸í•˜ê³  ë°˜í™˜ê°’ì„ ë³€ì¡°í•˜ì—¬ ìš°íšŒí•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ì´ë‹¤.</p><h3 id="ë„¤íŠ¸ì›Œí¬-íƒì§€ë¥¼-í†µí•œ-ìš°íšŒ-íƒì§€"><span class="me-2">ë„¤íŠ¸ì›Œí¬ íƒì§€ë¥¼ í†µí•œ ìš°íšŒ íƒì§€</span><a href="#ë„¤íŠ¸ì›Œí¬-íƒì§€ë¥¼-í†µí•œ-ìš°íšŒ-íƒì§€" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>ê·¸ëŸ¼ ì´ë²ˆì—ëŠ” ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•˜ì—¬ ìš°íšŒ íƒì§€ë¥¼ ì§„í–‰í•´ë³´ë ¤ê³  í•œë‹¤.</p><p>netstat ëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ë‚˜ ë””ë°”ì´ìŠ¤ì— ë„¤íŠ¸ì›Œí¬ ìƒíƒœë¥¼ ë³´ì—¬ì£¼ëŠ” ëª…ë ¹ì–´ì´ë‹¤.</p><p>ëª…ë ¹ì–´ë¥¼ í†µí•´ ì•„ë˜ì™€ ê°™ì´ í˜„ì¬ ì—°ê²°ëœ ì •ë³´ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.</p><div class="language-shell nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>x1q:/proc/21522 <span class="c"># netstat | grep ruffalo                                                                                </span>
unix  3      <span class="o">[</span> <span class="o">]</span>         STREAM     CONNECTED     29075456 @/ruffalo-87868e60-a33d-415a-ba9e-2718ebaf230d
unix  2      <span class="o">[</span> <span class="o">]</span>         STREAM     CONNECTED     7130091  @/ruffalo-c99f0fff-fcd1-42ff-a321-4e2546485a58
unix  2      <span class="o">[</span> <span class="o">]</span>         STREAM     CONNECTED     3545381  @/ruffalo-6afc2dde-d4d1-4050-8c17-b91aa1a0afae

                                        <span class="o">{</span> <span class="nb">.</span> <span class="nb">.</span> .<span class="o">}</span>

unix  2      <span class="o">[</span> <span class="o">]</span>         STREAM     CONNECTED     5332037  @/ruffalo-f561ed25-df09-40c5-b0fe-ee037f88f74a
unix  2      <span class="o">[</span> <span class="o">]</span>         STREAM     CONNECTED     7213926  @/ruffalo-c4e008d7-df55-4d85-a5b0-61ffe3f548d4
x1q:/proc/21522 <span class="c"># </span>
</pre></table></code></div></div><p>ì•„ë˜ì™€ ê°™ì´ ë™ì¼í•˜ê²Œ íŠ¹ì • ë¬¸ìì—´ì„ íƒì§€í•  ìˆ˜ ìˆë‹¤.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kt">char</span><span class="o">*</span> <span class="n">p_result</span> <span class="o">=</span> <span class="n">strstr</span><span class="p">(</span><span class="n">readline_from_process</span><span class="p">,</span> <span class="s">"ruffalo"</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">NULL</span> <span class="o">!=</span> <span class="n">p_result</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Detected</span>
  <span class="n">__android_log_print</span><span class="p">(</span><span class="n">ANDROID_LOG_VERBOSE</span><span class="p">,</span> <span class="s">"Sample-Test"</span><span class="p">,</span> <span class="s">"Found"</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>netstat ì‹¤í–‰ì„ í†µí•´ í•´ë‹¹ ë¬¸ìì—´ì„ íŒŒì‹±í•˜ê³  íƒì§€í•˜ë ¤ëŠ” ë¬¸ìì—´ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒì´ë‹¤.</p><p>ëª…ë ¹ì–´ ê²°ê³¼ì— ë”°ë¼ êµ¬í˜„ ë¡œì§ì´ íŠ•ê¸¸ ìˆ˜ ìˆì–´ì„œ ëª¨ë“  ê²½ìš°ì˜ ìˆ˜ì— ë‹¤ ë¶€í•©í•˜ê²Œ ì‘ì„±í•˜ëŠ” ê²Œ ì¤‘ìš”í•˜ë‹¤.</p><h3 id="ë„¤íŠ¸ì›Œí¬-íƒì§€-ìš°íšŒ"><span class="me-2">ë„¤íŠ¸ì›Œí¬ íƒì§€ ìš°íšŒ</span><a href="#ë„¤íŠ¸ì›Œí¬-íƒì§€-ìš°íšŒ" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>ìœ„ì—ì„œ êµ¬í˜„í•œ netstat ë¥¼ í™•ì¸í•˜ê³  ì´ë•Œ ì‹¤í–‰ì¤‘ì¸ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ëŠ” ì½”ë“œë¥¼ ìš°íšŒí•œë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì„ ê²ƒì´ë‹¤.</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="nx">Interceptor</span><span class="p">.</span><span class="nf">attach</span><span class="p">(</span><span class="nx">Module</span><span class="p">.</span><span class="nf">getExportByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">libc.so</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">strstr</span><span class="dl">'</span><span class="p">),</span> <span class="p">{</span>
    <span class="na">onEnter</span><span class="p">:</span> <span class="nf">function </span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">str1</span> <span class="o">=</span> <span class="nx">Memory</span><span class="p">.</span><span class="nf">readCString</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
        <span class="kd">var</span> <span class="nx">str2</span> <span class="o">=</span> <span class="nx">Memory</span><span class="p">.</span><span class="nf">readCString</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">str2</span><span class="p">.</span><span class="nf">indexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">ruffalo</span><span class="dl">"</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
            <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">str1:%s str2:%s</span><span class="se">\n</span><span class="dl">"</span><span class="p">,</span> <span class="nx">str1</span><span class="p">,</span> <span class="nx">str2</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">hook</span><span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">},</span>        
    <span class="na">onLeave</span><span class="p">:</span> <span class="nf">function </span><span class="p">(</span><span class="nx">retval</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hook</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">retval</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="mh">0x0</span><span class="p">);</span>
            <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Replace ret value to 0</span><span class="dl">"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></table></code></div></div><p>ìœ„ì™€ ê°™ì´ íŠ¹ì • ë¬¸ìì—´ì„ ì°¾ì•„ì„œ ëŒ€ì…í•´ì£¼ë©´ ì‰½ê²Œ ìš°íšŒê°€ ê°€ëŠ¥í•˜ë‹¤.</p><h3 id="í¬íŠ¸-ìŠ¤ìº”-íƒì§€ë¥¼-í†µí•œ-ìš°íšŒ-íƒì§€"><span class="me-2">í¬íŠ¸ ìŠ¤ìº” íƒì§€ë¥¼ í†µí•œ ìš°íšŒ íƒì§€</span><a href="#í¬íŠ¸-ìŠ¤ìº”-íƒì§€ë¥¼-í†µí•œ-ìš°íšŒ-íƒì§€" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>ê·¸ëŸ¼ ì´ë²ˆì—” í¬íŠ¸ ìŠ¤ìº”ì„ í†µí•´ ìš°íšŒ íƒì§€ë¥¼ ì§„í–‰í•´ë³´ê² ë‹¤.</p><p><code class="language-plaintext highlighter-rouge">netstat</code> ì— <code class="language-plaintext highlighter-rouge">-ntlp</code> ë¥¼ ì‚¬ìš©í•˜ë©´ LISTEN ì¤‘ì¸ í¬íŠ¸ ì •ë³´ í‘œì‹œí•œë‹¤.</p><blockquote class="prompt-info"><p>Frida ê°™ì€ ê²½ìš° ì‹¤í–‰ ì‹œ í¬íŠ¸ë¥¼ ì§€ì •í•  ìˆ˜ ìˆì–´ì„œ ì†ì‰½ê²Œ í¬íŠ¸ ë³€ê²½ì´ ê°€ëŠ¥í•˜ë‹¤.</p></blockquote><div class="language-shell nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>x1q:/proc/21522 <span class="c"># netstat -ntlp | grep ruffalo                                                                                       </span>
tcp        0      0 127.0.0.1:27042         0.0.0.0:<span class="k">*</span>               LISTEN      24938/ruffalo-server-16.6.3-android-arm64
tcp6       0      0 <span class="o">[</span>::]:34459              <span class="o">[</span>::]:<span class="k">*</span>                  LISTEN      24938/ruffalo-server-16.6.3-android-arm64
x1q:/proc/21522 <span class="c">#</span>
</pre></table></code></div></div><p>ì´ëŠ” ì•„ë˜ì˜ ì˜µì…˜ë“¤ì´ ì¡°í•©ëœ ê²ƒì´ë‹¤.</p><div class="language-shell nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nt">-l</span>	Listening server sockets
<span class="nt">-t</span>	TCP sockets
<span class="nt">-n</span>	Don<span class="s1">'t resolve names
-p	Show PID/program name of sockets
</span></pre></table></code></div></div><p>ì´ë¥¼ í†µí•´ ì—´ë ¤ìˆëŠ” í¬íŠ¸ë¥¼ ê²€ì‚¬í•˜ê±°ë‚˜ ë¬¸ìì—´ì„ ê²€ì‚¬í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">bool</span> <span class="n">result</span> <span class="o">=</span> <span class="n">strstr</span><span class="p">(</span><span class="n">readline_netstat</span><span class="p">,</span> <span class="s">"27042"</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">strstr</span><span class="p">(</span><span class="n">readline_netstat</span><span class="p">,</span> <span class="s">"LISTEN"</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">true</span> <span class="o">==</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Detected</span>
  <span class="n">__android_log_print</span><span class="p">(</span><span class="n">ANDROID_LOG_VERBOSE</span><span class="p">,</span> <span class="s">"Sample-Test"</span><span class="p">,</span> <span class="s">"Found"</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>ìœ„ì²˜ëŸ¼ netstat ê²°ê³¼ì—ì„œ ì•Œ ìˆ˜ ìˆë“¯ì´ ì—´ë ¤ìˆëŠ” í¬íŠ¸ ë²ˆí˜¸ì™€ í˜„ì¬ LISTEN ìƒíƒœì¸ì§€ íƒì§€í•˜ëŠ” ê²ƒì´ë‹¤.</p><h3 id="í¬íŠ¸-ìŠ¤ìº”-íƒì§€-ìš°íšŒ"><span class="me-2">í¬íŠ¸ ìŠ¤ìº” íƒì§€ ìš°íšŒ</span><a href="#í¬íŠ¸-ìŠ¤ìº”-íƒì§€-ìš°íšŒ" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>í¬íŠ¸ ìŠ¤ìº” ë°©ì‹ë„ ìš°íšŒí•œë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì„ ê²ƒì´ë‹¤.</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="nx">Interceptor</span><span class="p">.</span><span class="nf">attach</span><span class="p">(</span><span class="nx">Module</span><span class="p">.</span><span class="nf">getExportByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">libc.so</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">strstr</span><span class="dl">'</span><span class="p">),</span> <span class="p">{</span>
    <span class="na">onEnter</span><span class="p">:</span> <span class="nf">function </span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">str1</span> <span class="o">=</span> <span class="nx">Memory</span><span class="p">.</span><span class="nf">readCString</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
        <span class="kd">var</span> <span class="nx">str2</span> <span class="o">=</span> <span class="nx">Memory</span><span class="p">.</span><span class="nf">readCString</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">str2</span><span class="p">.</span><span class="nf">indexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">27042</span><span class="dl">"</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span>
         <span class="o">||</span> <span class="nx">str2</span><span class="p">.</span><span class="nf">indexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">LISTEN</span><span class="dl">"</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
            <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">str1:%s str2:%s</span><span class="se">\n</span><span class="dl">"</span><span class="p">,</span> <span class="nx">str1</span><span class="p">,</span> <span class="nx">str2</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">hook</span><span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">},</span>        
    <span class="na">onLeave</span><span class="p">:</span> <span class="nf">function </span><span class="p">(</span><span class="nx">retval</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hook</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">retval</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="mh">0x0</span><span class="p">);</span>
            <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Replace ret value to 0</span><span class="dl">"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></table></code></div></div><p>í¬íŠ¸ ë²ˆí˜¸ì™€ LISTEN ë¬¸ìì—´ì¼ ë•Œ ë°˜í™˜ê°’ì„ ë³€ì¡°í•˜ì—¬ ìš°íšŒí•œë‹¤.</p><h2 id="conclusion"><span class="me-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>ì§€ê¸ˆê¹Œì§€ Frida ë¥¼ íƒì§€í•  ìˆ˜ ìˆëŠ” ë°©ë²•ë“¤ì„ ì‚´í´ë³´ì•˜ë‹¤. ì´ì™¸ì—ë„ ìˆ˜ì‹­ê°€ì§€ ë°©ë²•ìœ¼ë¡œ Frida ë¥¼ íƒì§€í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ì¡´ì¬í•œë‹¤. í•˜ì§€ë§Œ ì¬ë°ŒëŠ” ì ì€ Frida ë¥¼ í†µí•´ Frida íƒì§€ ê¸°ëŠ¥ì„ ìš°íšŒí•  ìˆ˜ ìˆë‹¤ëŠ” ì ì´ë‹¤.</p><p>ë©”ëª¨ë¦¬ ë™ì‘ì„ í†µí•œ íƒì§€ ë°©ë²•ì€ ê¹Šê²Œ ì•Œì•„ë´ì•¼ í•˜ì§€ë§Œ ìš°íšŒëŠ” íƒì§€ ê¸°ëŠ¥ì„ ë¹„ì›ƒëŠ” ê²ƒì²˜ëŸ¼ ì•„ì£¼ ì†ì‰½ê²Œ í›„í‚¹ì„ í†µí•´ íšŒí”¼í•  ìˆ˜ ìˆë‹¤.</p><p>íƒì§€í•˜ëŠ” ê¸°ëŠ¥ì´ë“  ìš°íšŒë“  ë°©ë„ë¥¼ ì•Œì•„ë³´ê¸° ìœ„í•˜ì—¬ ê¹Šìˆ™í•˜ê²Œ ì•Œì•„ë´ì•¼ í•˜ëŠ” ê±´ ë™ì¼í•˜ë‹¤.</p><p>ìœ„ í™˜ê²½ì€ ì‚¬ì‹¤ ì¼ë°˜ì ì¸ ì•± ìƒí…Œì—ì„œ ê°ì§€í•´ì•¼ í•˜ëŠ” ê²ƒì´ ì¡°ê±´ì´ë¯€ë¡œ ì¢€ ë” ì•„ì´ë””ì–´ë¥¼ ë‚´ì•¼ í•  ë¶€ë¶„ì´ ë§ì„ ê²ƒì´ë‹¤. ì ìš©í•  ìˆ˜ ì—†ëŠ” ì•„ì´ë””ì–´ê°€ í›¨ì”¬ ë§ì„ ê²ƒì´ë©° ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ë°©ë²•ë“¤ë„ ë§ì„ ê²ƒì´ë‹¤.</p><p>ì´ì™€ ë¹„ìŠ·í•˜ê²Œ ë£¨íŒ… ê¸°ìˆ  ë˜í•œ ë¹„ìŠ·í•œ ìŠ¤í† ë¦¬ë¥¼ ê°€ì§€ê³  ìˆë‹¤. ë£¨íŒ…ì€ shamiko ë¼ëŠ” ëª¨ë“ˆì„ í†µí•´ ì¶”ê°€ì ìœ¼ë¡œ zygisk í”ì ì„ ì§€ìš°ëŠ”ë° ì‚¬ìš©ëœë‹¤.</p><p>ìˆ˜ì°¨ë¡€ ë³´ì•ˆê°œë°œìë“¤ì´ íƒì§€ ë°©ë²•ì„ ì°¾ì•„ë‚´ë©´ì„œ Magisk ìª½ì—ì„œë„ ëª‡ë²ˆ íŒ¨ì¹˜ë¥¼ í•˜ëŠ”ë° ì´ë˜í•œ ê¸¸ê³  ê¸´ ê³µë°©ì „ìœ¼ë¡œ ì´ì–´ì§€ê³¤ í–ˆë‹¤.</p><p>íƒì§€ ë°©ë²•ì„ ê°€ì¡Œë‹¤í•˜ë”ë¼ë„ 2ì°¨, 3ì°¨ì ìœ¼ë¡œ ëŒ€ì±…ì„ ì„¸ì›Œì•¼ í•  ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤.</p><p>ë‹¨ìˆœí•˜ê²Œ ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ íƒì§€ ë¡œì§ì´ í›¤íˆ ì½í˜€ ê¸ˆë°© ìš°íšŒê°€ ê°€ëŠ¥í•˜ë‹¤.</p><p>ë‚œë…í™”ë‚˜ ì•”í˜¸í™” ë˜ëŠ” í˜•ì‹í™”ëœ í˜¸ì¶œì„ í”¼í•˜ê±°ë‚˜ í•œ ë‹¨ê³„ ë‚®ì€ ë„¤ì´í‹°ë¸Œ ë ˆë²¨ì˜ ì–¸ì–´ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ìš°íšŒë¥¼ ìœ„í•œ ë¶„ì„ ë˜í•œ ì‰½ì§€ ì•Šì„ ê²ƒì´ë‹¤.</p><p>ê·¸ë˜ì„œ ê¸ˆìœµì•±ì´ë‚˜ í•€í…Œí¬ ì•±ì€ ê¹Šì€ ê³³ì— ë³´ì•ˆê¸°ìˆ ì´ ê½ê½ ìˆ¨ê²¨ì ¸ìˆì–´ ê³µê²©ìë“¤ì€ ì´ë¥¼ íŒŒí—¤ì³ ìš°íšŒí•  ìˆ˜ ìˆëŠ” ë¡œì§ì„ ì°¾ì•„ë‚´ê¸°ë„ í•œë‹¤.</p><p>ê·¸ë ‡ê²Œë˜ë©´ ìš°íšŒëŠ” ì´ì „ê³¼ ë‹¤ë¥´ê²Œ ë•Œë¡  Direct í•˜ê²Œ ì ‘ê·¼í•´ì•¼ í•  ìˆ˜ ìˆê³  íƒì§€ ë¡œì§ì„ ë¬´ë ¥í™”í•˜ê¸° ìœ„í•˜ì—¬ ê¸°ì¡´ì— ìœ íš¨í–ˆë˜ íƒì§€ ì•„ì´ë””ì–´ë“¤ì„ ì˜ë¯¸ì—†ê±°ë‚˜ ëœë¤í•œ ê°’ìœ¼ë¡œ ë°”ë€ ë°”ì´ë„ˆë¦¬ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p><p>ì´ì™¸ì—ë„ ë§ì€ ë„êµ¬ì™€ í™˜ê²½ë“¤ì´ ìˆëŠ”ë° ì´ëŸ¬í•œ ê²ƒë“¤ì€ ì‹¤í–‰ ì‹œ ì•ˆë“œë¡œì´ë“œ ê¹Šìˆ™í•œ ë©”ëª¨ë¦¬ ì–´ë”˜ê°€ì— í”ì ì„ ë‚¨ê¸°ë©° ì´ë¥¼ ì½”ë“œë¡œ ë¡œì§í™”í•˜ë©´ ì •ìƒì ìœ¼ë¡œ íƒì§€í•  ìˆ˜ ìˆë‹¤.</p><p>ê·¸ëŸ¬ë‚˜ ìµœê·¼ ì½”ë“œ Binary instrumentation ê¸°ëŠ¥ì´ ê°•í™”ë˜ì–´ ì•± ì‹œì‘ ì „ dynamic hook ì„ ì¤€ë¹„í•˜ì—¬ ëª¨ë“  ì½”ë“œ í˜¸ì¶œë¶€ë¥¼ ì¶”ì í•  ìˆ˜ ìˆë‹¤.</p><p>ë”°ë¼ì„œ ì•„ë¬´ë¦¬ ì™„ë²½í•œ íƒì§€ ì‹œê·¸ë‹ˆì²˜ì™€ ìˆ˜ë‹¨ì„ ê°€ì¡Œë‹¤í•˜ë”ë¼ë„ ë§ˆì¹¨ë‚´ ë¡œì§ì€ ì‰½ê²Œ ìš°íšŒë  ê²ƒì´ë‹¤.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/research/">research</a>, <a href="/categories/android/">android</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/android/" class="post-tag no-text-decoration" >android</a> <a href="/tags/research/" class="post-tag no-text-decoration" >research</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author. <br>If you find any errors, please let me know by comment or email. Thank you.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Frida%20%ED%83%90%EC%A7%80%20%EB%B0%A9%EB%B2%95%EC%97%90%20%EB%8C%80%ED%95%9C%20%EA%B3%A0%EC%B0%B0%20-%20Unforgettable&url=https%3A%2F%2Fruffalolavoisier.github.io%2Fposts%2Fidea_for_detect_frida%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Frida%20%ED%83%90%EC%A7%80%20%EB%B0%A9%EB%B2%95%EC%97%90%20%EB%8C%80%ED%95%9C%20%EA%B3%A0%EC%B0%B0%20-%20Unforgettable&u=https%3A%2F%2Fruffalolavoisier.github.io%2Fposts%2Fidea_for_detect_frida%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fruffalolavoisier.github.io%2Fposts%2Fidea_for_detect_frida%2F&text=Frida%20%ED%83%90%EC%A7%80%20%EB%B0%A9%EB%B2%95%EC%97%90%20%EB%8C%80%ED%95%9C%20%EA%B3%A0%EC%B0%B0%20-%20Unforgettable" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/malware_analysis_a_encrypted_string/">ë™ì ìœ¼ë¡œ ë¡œë“œë˜ëŠ” ì‹¤í–‰ íŒŒì¼ì— ëŒ€í•œ ê³ ì°° - 3</a><li class="text-truncate lh-lg"> <a href="/posts/detect-screencapture/">ì‚¬ìš©ìì˜ í–‰ë™ì„ ê°ì‹œí•˜ëŠ” ì½”ë“œ - screen capture</a><li class="text-truncate lh-lg"> <a href="/posts/researched_encrypt_string_malware_2/">ì•…ì„±ì½”ë“œ ì•ˆì— ì•”í˜¸í™”ëœ ë¬¸ìì—´ í•´ì œí•˜ê¸°</a><li class="text-truncate lh-lg"> <a href="/posts/unpacking_malware_core_3/">ì•…ì„±ì½”ë“œ ì•ˆì— íŒ¨í‚¹ëœ ì‹¤í–‰íŒŒì¼ ëœ¯ì–´ë‚´ê¸°</a><li class="text-truncate lh-lg"> <a href="/posts/malware_analysis_a/">ë™ì ìœ¼ë¡œ ë¡œë“œë˜ëŠ” ì‹¤í–‰ íŒŒì¼ì— ëŒ€í•œ ê³ ì°° - 1</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/research/">research</a> <a class="post-tag btn btn-outline-primary" href="/tags/android/">android</a> <a class="post-tag btn btn-outline-primary" href="/tags/develop/">develop</a> <a class="post-tag btn btn-outline-primary" href="/tags/git/">git</a> <a class="post-tag btn btn-outline-primary" href="/tags/blog/">blog</a> <a class="post-tag btn btn-outline-primary" href="/tags/malware/">Malware</a> <a class="post-tag btn btn-outline-primary" href="/tags/linux/">linux</a> <a class="post-tag btn btn-outline-primary" href="/tags/research/">Research</a> <a class="post-tag btn btn-outline-primary" href="/tags/android/">Android</a> <a class="post-tag btn btn-outline-primary" href="/tags/mobile/">mobile</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/bypass_rasp/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1745775582" data-df="ll" > Apr 28, 2025 </time><h4 class="pt-0 my-2"><b>RASP ì— ëŒ€í•œ ê³ ì°°</b></h4><div class="text-muted"><p>Runtime Application Self-Protection (RASP)</p></div></div></a></article><article class="col"> <a href="/posts/format-manifest/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1742275686" data-df="ll" > Mar 18, 2025 </time><h4 class="pt-0 my-2"><b>Anti-Reversing ì„ í†µí•œ Androidmanifest ë³µì›í•˜ê¸°</b></h4><div class="text-muted"><p>Androidmanifest file format layout</p></div></div></a></article><article class="col"> <a href="/posts/about_file_api/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1741610146" data-df="ll" > Mar 10, 2025 </time><h4 class="pt-0 my-2"><b>ì•ˆë“œë¡œì´ë“œ ì•± ì‹¤í–‰ ì‹œ ì–´ë–¤ íŒŒì¼ë“¤ì— ì ‘ê·¼í• ê¹Œ</b></h4><div class="text-muted"><p>How to access file on Android</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/malware_analysis_a/" class="btn btn-outline-primary" aria-label="Older" ><p><b>ë™ì ìœ¼ë¡œ ë¡œë“œë˜ëŠ” ì‹¤í–‰ íŒŒì¼ì— ëŒ€í•œ ê³ ì°° - 1</b></p></a> <a href="/posts/adb_install/" class="btn btn-outline-primary" aria-label="Newer" ><p><b>adb ë¡œ apk ì„¤ì¹˜í•˜ê¸°</b></p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>Â© <time>2025</time> <a href="https://github.com/RuffaloLavoisier">Ruffalo</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p><div class='typing'>I'm <STRONG><span class="text"></span></STRONG></div><script> document.addEventListener("DOMContentLoaded", function () { const $text = document.querySelector(".typing .text"); const letters = [ "Developer", "Author", "Creator", "Inventor", "Conductor", "Traveler" ]; const speed = 100; let i = 0; const typing = async () => { const letter = letters[i].split(""); while (letter.length) { await wait(speed); $text.innerHTML += letter.shift(); } await wait(800); remove(); }; const remove = async () => { const letter = letters[i].split(""); while (letter.length) { await wait(speed); letter.pop(); $text.innerHTML = letter.join(""); } i = !letters[i + 1] ? 0 : i + 1; typing(); }; function wait(ms) { return new Promise(res => setTimeout(res, ms)) } setTimeout(typing, 1500); }); </script></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.3.0" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/research/">research</a> <a class="post-tag btn btn-outline-primary" href="/tags/android/">android</a> <a class="post-tag btn btn-outline-primary" href="/tags/develop/">develop</a> <a class="post-tag btn btn-outline-primary" href="/tags/git/">git</a> <a class="post-tag btn btn-outline-primary" href="/tags/blog/">blog</a> <a class="post-tag btn btn-outline-primary" href="/tags/malware/">Malware</a> <a class="post-tag btn btn-outline-primary" href="/tags/linux/">linux</a> <a class="post-tag btn btn-outline-primary" href="/tags/research/">Research</a> <a class="post-tag btn btn-outline-primary" href="/tags/android/">Android</a> <a class="post-tag btn btn-outline-primary" href="/tags/mobile/">mobile</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><script> (function () { const origin = 'https://utteranc.es'; const themeMapper = Theme.getThemeMapper('github-light', 'github-dark'); const initTheme = themeMapper[Theme.visualState]; let script = document.createElement('script'); script.src = 'https://utteranc.es/client.js'; script.setAttribute('repo', 'RuffaloLavoisier/ruffalolavoisier.github.io'); script.setAttribute('issue-term', 'pathname'); script.setAttribute('theme', initTheme); script.crossOrigin = 'anonymous'; script.async = true; const $footer = document.querySelector('footer'); $footer.insertAdjacentElement('beforebegin', script); addEventListener('message', (event) => { let newTheme;if (event.source === window && event.data && event.data.id === Theme.ID) { newTheme = themeMapper[Theme.visualState]; const message = { type: 'set-theme', theme: newTheme }; const utterances = document.querySelector('.utterances-frame').contentWindow; utterances.postMessage(message, origin); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
