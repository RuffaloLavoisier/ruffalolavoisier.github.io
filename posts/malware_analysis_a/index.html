<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="동적으로 로드되는 실행 파일에 대한 고찰 - 1" /><meta property="og:locale" content="en" /><meta name="description" content="Introduction" /><meta property="og:description" content="Introduction" /><link rel="canonical" href="https://ruffalolavoisier.github.io/posts/malware_analysis_a/" /><meta property="og:url" content="https://ruffalolavoisier.github.io/posts/malware_analysis_a/" /><meta property="og:site_name" content="Unforgettable" /><meta property="og:image" content="https://ruffalolavoisier.github.io/assets/img/common/rnd.webp" /><meta property="og:image:alt" content="Dyanmic Dex File loading" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-03-12T10:04:03+09:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://ruffalolavoisier.github.io/assets/img/common/rnd.webp" /><meta name="twitter:image:alt" content="Dyanmic Dex File loading" /><meta property="twitter:title" content="동적으로 로드되는 실행 파일에 대한 고찰 - 1" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-06-16T07:50:25+09:00","datePublished":"2025-03-12T10:04:03+09:00","description":"Introduction","headline":"동적으로 로드되는 실행 파일에 대한 고찰 - 1","image":{"lqip":"data:image/webp;base64","alt":"Dyanmic Dex File loading","url":"https://ruffalolavoisier.github.io/assets/img/common/rnd.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ruffalolavoisier.github.io/posts/malware_analysis_a/"},"url":"https://ruffalolavoisier.github.io/posts/malware_analysis_a/"}</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2677268060283942" crossorigin="anonymous"></script><title>동적으로 로드되는 실행 파일에 대한 고찰 - 1 | Unforgettable</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Unforgettable"><meta name="application-name" content="Unforgettable"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js,npm/mermaid@11.4.0/dist/mermaid.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script> <script>mermaid.initialize({startOnLoad:true});</script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="https://ruffalolavoisier.github.io/assets/img/profile/profile_new.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Unforgettable</a><p class="site-subtitle fst-italic mb-0">I wonder Why I wonder</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/project/" class="nav-link"> <i class="fa-fw fas fa-laptop-code"></i> <span>PROJECT</span> </a><li class="nav-item"> <a href="/interest/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>INTEREST</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/RuffaloLavoisier" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['RuffaloLavoisier','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://stackoverflow.com/users/17522538/ruffalo" aria-label="stack-overflow" target="_blank" rel="noopener noreferrer" > <i class="fab fa-stack-overflow"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>동적으로 로드되는 실행 파일에 대한 고찰 - 1</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip><b>동적으로 로드되는 실행 파일에 대한 고찰 - 1</b></h1><i>Malware Analysis - dex file</i><div class="post-meta text-muted"> <span> Posted <time data-ts="1741741443" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Mar 12, 2025 </time> </span> <span> Updated <time data-ts="1750027825" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 16, 2025 </time> </span><div class="mt-3 mb-3"> <a href="https://ruffalolavoisier.github.io/assets/img/common/rnd.webp" class="popup img-link preview-img blur"><img data-src="https://ruffalolavoisier.github.io/assets/img/common/rnd.webp" alt="Dyanmic Dex File loading" width="1200" height="630" data-lqip="true" src="data:image/webp;base64"></a><figcaption class="text-center pt-2 pb-2">Dyanmic Dex File loading</figcaption></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/RuffaloLavoisier">Ruffalo</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1856 words" > <em>10 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">동적으로 로드되는 실행 파일에 대한 고찰 - 1</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">동적으로 로드되는 실행 파일에 대한 고찰 - 1</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><h2 id="introduction"><span class="me-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>최근 여러 개의 Malware 를 포함해서 software-protection 이 적용된 앱들을 분석할 기회가 생겼다. Malware 라고 단정 지을 수 없지만 안티 리버싱이 적용된 앱들이 많아 평소보다 분석이 쉽지 않았던 케이스가 많았다. 이러한 목적은 소스코드 방어 목적도 있지만 어떤 의도를 가진 소프트웨어인지 비공개하기 위한 여러가지 제한을 하고자 적용한 앱들도 있다. 이러한 앱들을 분석해보면 메인 코드가 대부분 비어있었다. 그러나 앱을 실행하면 정상적으로 구동되는 앱들이었다.</p><p>디바이스에 존재하지 않는 코드가 어떻게 실행되는지 살펴본 결과 기상천외한 방법들이 있었고 그중 일반적인 것이 파일을 다운받는 형태를 볼 수 있었다. 과정을 복잡하게 해놓는 게 대부분이긴 하지만 네트워크 통신할 때 패킷을 살펴보면 실행파일을 가쟈오는 걸 알 수 있다.</p><p>해당 글에서는 동적으로 생기는 파일을 확인하고 메모리에 올라가는 실행 파일을 확인하는 것까지 진행해보겠다.</p><h3 id="what-is-that"><span class="me-2">What is that</span><a href="#what-is-that" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>바이너리에 존재하지 않는 코드가 어떻게 실행 시 문제 없이 진행되는 걸 보면 Android 에서 동적으로 로드할 수 있는 몇가지 API 가 있다.</p><pre><code class="language-mermaid">
classDiagram
    ClassLoader &lt;|-- BaseDexClassLoader
    BaseDexClassLoader &lt;|-- DexClassLoader
    BaseDexClassLoader &lt;|-- PathClassLoader
    class ClassLoader{
    }
    class DexClassLoader{
        -load()
    }
    class PathClassLoader{
        +load()
    }
</code></pre><p>위와 같이 동적으로 로드할 수 있는 클래스가 있는데 이중에서 <code class="language-plaintext highlighter-rouge">DexClassLoader</code> 를 중점으로 바라보고자 한다. 또한 이중 빠진 API 가 있는데 메모리에서 로드하는 <code class="language-plaintext highlighter-rouge">InMemoryDexClassLoader</code> API 가 누락되었다.</p><h2 id="how-we-got-here"><span class="me-2">How We Got Here</span><a href="#how-we-got-here" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">assets/</code> 에 저장되어있는 파일을 불러와 안드로이드 내부에 저장하는 걸 볼 수 있는데 이때 <code class="language-plaintext highlighter-rouge">File</code> API 를 확인하면 실행 시 동적으로 내부에 파일을 저장하는 걸 볼 수 있다.</p><p>안드로이드 내부 디렉터리에 관한 내용은 다음과 같은 <a href="https://ruffalolavoisier.github.io/posts/access_app_directory/">글</a>에 따로 정리하였다.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>[*] b'Hidden File opened for write /data/user/0/ww.rksr.jjiuuuu.lsls/nnn.dex'
[*] b'Got 503724 bytes!'
[*] b'Waiting..'
[*] b'Write..'
[*] Successfully dumped to nnn.dex
</pre></table></code></div></div><p>위와 같이 실행 시 파일을 생성한 후 assets 에 있는 내용을 로컬에 저장하는 걸 확인할 수 있다.</p><p>dex 를 로드하는 방법에는 몇년 전만해도 한 가지 방법 밖에 없었는데 최근 들어 디바이스 내에 그 어떤 파일을 만들지 않고 메모리 영역에 올려 코드를 로드하는 방법이 생겼다.</p><p>그래서 총 2가지 방법이 있는데 여기서 2가지 방법 다 다뤄볼 생각이다.</p><h2 id="a-critical-breakthrough"><span class="me-2">A Critical Breakthrough</span><a href="#a-critical-breakthrough" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="file-로-로드하는-방법"><span class="me-2">File 로 로드하는 방법</span><a href="#file-로-로드하는-방법" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>assets 에 있는 파일을 안드로이드 내부 디렉터리에 저장한 후 동적으로 해당 파일을 로드하는 방법이다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="nf">DexClassLoader</span> <span class="o">(</span><span class="nc">String</span> <span class="n">dexPath</span><span class="o">,</span> 
               <span class="o">,</span> <span class="nc">String</span> <span class="n">optimizedDirectory</span>
               <span class="o">,</span> <span class="nc">String</span> <span class="n">librarySearchPath</span> 
                 <span class="nc">ClassLoader</span> <span class="n">parent</span><span class="o">)</span>
</pre></table></code></div></div><p>파일을 로드할 때는 위와 같은 API 를 사용하여 진행한다.</p><p>동적으로 로드된 dex 파일을 확인하면 아래와 같이 apk 바이너리 안에 있는 dex 파일을 포함하여 실행 시 로드되는 dex 들을 함께 확인할 수 있다.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="o">[</span>Dex1] : /data/user/0/ww.rksr.jjiuuuu.lsls/classes1.dex
<span class="o">[</span>Dex2] : /data/user/0/ww.rksr.jjiuuuu.lsls/classes2.dex
<span class="o">[</span>Dex3] : /data/user/0/ww.rksr.jjiuuuu.lsls/classes3.dex
<span class="o">[</span>Dex4] : /data/user/0/ww.rksr.jjiuuuu.lsls/classes4.dex
<span class="o">[</span>Dex5] : /data/user/0/ww.rksr.jjiuuuu.lsls/classes5.dex
<span class="o">[</span>Dex6] : /data/user/0/ww.rksr.jjiuuuu.lsls/classes6.dex
<span class="o">[</span>Dex7] : /data/user/0/ww.rksr.jjiuuuu.lsls/classes7.dex
<span class="o">[</span>Dex8] : /data/user/0/ww.rksr.jjiuuuu.lsls/classes8.dex
<span class="o">[</span>Dex9] : /data/user/0/ww.rksr.jjiuuuu.lsls/classes9.dex
<span class="o">[</span>Dex10] : /data/user/0/ww.rksr.jjiuuuu.lsls/classes10.dex
<span class="o">[</span>Dex11] : /data/user/0/ww.rksr.jjiuuuu.lsls/classes11.dex
<span class="o">[</span>Dex12] : /data/user/0/ww.rksr.jjiuuuu.lsls/classes12.dex
<span class="o">[</span>Dex13] : /data/user/0/ww.rksr.jjiuuuu.lsls/classes13.dex
</pre></table></code></div></div><p>여기서 일반 dex file 도 볼 수 있고 실행 중 올라간 dex file 도 확인할 수 있다.</p><h3 id="memory-에서-로드하는-방법"><span class="me-2">Memory 에서 로드하는 방법</span><a href="#memory-에서-로드하는-방법" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>로컬 내부 디렉터리에 파일을 따로 생성하지 않고 <code class="language-plaintext highlighter-rouge">assets/</code> 에서 파일을 Byte 로 읽은 후 실행 중 바로 메모리 상에서 로드하는 방법이다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="nf">InMemoryDexClassLoader</span> <span class="o">(</span><span class="nc">ByteBuffer</span> <span class="n">dexBuffer</span>
              <span class="o">,</span> <span class="nc">ClassLoader</span> <span class="n">parent</span><span class="o">)</span>
</pre></table></code></div></div><p>해당 API 는 디렉터리에 파일을 따로 만들지 않고 실행 시 메모리에 로드되는 형태이다.</p><p>실행 시 확인하면 아래와 같이 메모리 상에 올라간 dex 를 로컬 디렉터리에 파일로 만들어서 dump 를 뜰 수 있다.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="o">[</span>+] Dex dumped successfully <span class="o">!</span>
<span class="o">=&gt;</span> /data/user/0/ww.rksr.jjiuuuu.lsls/2025_03_07_a_dump.dex
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Opening file name
<span class="o">=&gt;</span> /data/user/0/ww.rksr.jjiuuuu.lsls/2025_03_07_a_dump.dex to write 503724 bytes
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Writing size
<span class="o">=&gt;</span> 503724 bytes...
</pre></table></code></div></div><h2 id="conclusion"><span class="me-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">assets/</code> 에 리소스처럼 위장해있는 파일을 후킹하여 그리고 그 파일이 메모리에 올라가는 것까지 진행해보았다.</p><p>고이신 여러 리버서들의 의견을 들어보면 정말 흥미로운 패턴을 가진 소프트웨어가 많다고 한다.</p><p>그중 난독화와 더불어 파일을 숨기거나 조합하거나 끼워맞추는 게 많고 이리갔다 저리갔다 하는 패턴도 있다고 한다. 알게 모르게 피곤하고 성가신 기술들로 분석이 난해한 경우가 다반사라고 한다. 또한 난독화와 더불어 바이너리 수준으로 안티 리버싱이 적용된 케이스도 적지 않다고 하여 해당 케이스도 추후 정리해볼까 한다.</p><p>다음 글에 작성할 내용이지만 꽤 재밌었던 사례 중 하나는 모든 호출부를 네이티브로 코드를 내린 어플리케이션이다. 네이티브 라이브러리는 사실 암호화나 난독화를 하지 않아도 이미 컴파일된 바이너리로 디컴파일을 진행해도 기존 원본 코드를 유지할 수 없으며 이해하는 게 어렵기 때문에 대부분 네이티브로 내리는데 몇몇 리버서들이 이또한 분석하는 방법과 툴을 개발하여 네이티브 라이브러리 또한 암호화하는 도구들이 등장하였다.</p><p>당연히 그에 걸맞게 해당 암호화 방법들을 또한 역공학할 수 방법들이 때에 맞춰 여러 사람들이 글을 정리하여 세상에 나타났다.</p><p>다른 흥미로운 사례는 실행 중 분석할 수 있는 도구들을 탐지하는 케이스도 있고 이러한 분석 도구들을 농락이라도 하듯이 dummy call 로 유도하는 케이스도 굉장히 많았다. 실제로 이와 비슷한 케이스를 확인하면서 앱 동작에는 영향은 없지만 분석 도구를 붙이는 순간 포착하려는 기능이 발견되지 않는 재밌는 상황이 있었다.</p><p>그러나 결과적으로 빌드된 Android OS 에서 앱이 성공적으로 실행된다면 가장 최상위 부모 프로세스인 Zygote 부터 정적 분석과 동적 분석으로 하나씩 살펴보면서 Application 으로 들어가고 class call, method call, native call 쪽으로 파고들면 된다.</p><p>불가능한건 아니다. 새벽과 길고 긴 밤이 있으면 결국엔 알아낼 수 있는 것 같다, 이 글처럼 :)</p><h2 id="reference"><span class="me-2">Reference</span><a href="#reference" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>https://source.android.com/docs/core/runtime/dex-format https://developer.android.com/reference/java/lang/ClassLoader https://developer.android.com/reference/dalvik/system/DexClassLoader https://developer.android.com/reference/dalvik/system/InMemoryDexClassLoader</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/research/">Research</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/research/" class="post-tag no-text-decoration" >Research</a> <a href="/tags/android/" class="post-tag no-text-decoration" >Android</a> <a href="/tags/malware/" class="post-tag no-text-decoration" >Malware</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author. <br>If you find any errors, please let me know by comment or email. Thank you.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%EB%8F%99%EC%A0%81%EC%9C%BC%EB%A1%9C%20%EB%A1%9C%EB%93%9C%EB%90%98%EB%8A%94%20%EC%8B%A4%ED%96%89%20%ED%8C%8C%EC%9D%BC%EC%97%90%20%EB%8C%80%ED%95%9C%20%EA%B3%A0%EC%B0%B0%20-%201%20-%20Unforgettable&url=https%3A%2F%2Fruffalolavoisier.github.io%2Fposts%2Fmalware_analysis_a%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%EB%8F%99%EC%A0%81%EC%9C%BC%EB%A1%9C%20%EB%A1%9C%EB%93%9C%EB%90%98%EB%8A%94%20%EC%8B%A4%ED%96%89%20%ED%8C%8C%EC%9D%BC%EC%97%90%20%EB%8C%80%ED%95%9C%20%EA%B3%A0%EC%B0%B0%20-%201%20-%20Unforgettable&u=https%3A%2F%2Fruffalolavoisier.github.io%2Fposts%2Fmalware_analysis_a%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fruffalolavoisier.github.io%2Fposts%2Fmalware_analysis_a%2F&text=%EB%8F%99%EC%A0%81%EC%9C%BC%EB%A1%9C%20%EB%A1%9C%EB%93%9C%EB%90%98%EB%8A%94%20%EC%8B%A4%ED%96%89%20%ED%8C%8C%EC%9D%BC%EC%97%90%20%EB%8C%80%ED%95%9C%20%EA%B3%A0%EC%B0%B0%20-%201%20-%20Unforgettable" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/factory_reset_and_dell_charger_is_not_working/">공장 초기화 후 DELL 노트북 충전기의 동작에 관하여</a><li class="text-truncate lh-lg"> <a href="/posts/gitlab-with-slack/">Slack 에 웹훅(webhook) 연결하기</a><li class="text-truncate lh-lg"> <a href="/posts/vpn_from_freerdp_on_mac/">How to use VPN client on macOS ?</a><li class="text-truncate lh-lg"> <a href="/posts/bypass_rasp/">RASP 에 대한 고찰</a><li class="text-truncate lh-lg"> <a href="/posts/OSW/">Open smartwatch Contribution</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/research/">Research</a> <a class="post-tag btn btn-outline-primary" href="/tags/android/">Android</a> <a class="post-tag btn btn-outline-primary" href="/tags/develop/">Develop</a> <a class="post-tag btn btn-outline-primary" href="/tags/git/">Git</a> <a class="post-tag btn btn-outline-primary" href="/tags/malware/">Malware</a> <a class="post-tag btn btn-outline-primary" href="/tags/blog/">Blog</a> <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a> <a class="post-tag btn btn-outline-primary" href="/tags/mobile/">Mobile</a> <a class="post-tag btn btn-outline-primary" href="/tags/software-developer/">Software developer</a> <a class="post-tag btn btn-outline-primary" href="/tags/diary/">Diary</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/malware_analysis_a_encrypted_string/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1743533997" data-df="ll" > Apr 2, 2025 </time><h4 class="pt-0 my-2"><b>동적으로 로드되는 실행 파일에 대한 고찰 - 3</b></h4><div class="text-muted"><p>malware analysis a encrypted string</p></div></div></a></article><article class="col"> <a href="/posts/malware_analysis_a_loader/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1743436785" data-df="ll" > Apr 1, 2025 </time><h4 class="pt-0 my-2"><b>동적으로 로드되는 실행 파일에 대한 고찰 - 2</b></h4><div class="text-muted"><p>How to work on malware</p></div></div></a></article><article class="col"> <a href="/posts/quarter-3-dynamic-engine/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1695135600" data-df="ll" > Sep 20, 2023 </time><h4 class="pt-0 my-2"><b>달리는 자동차를 정비하는 방법</b></h4><div class="text-muted"><p>들어가며 올해 초는 정말 어떻게 살았는지 아직도 모를 때가 많다. 바쁘기도 바쁘지만 앞이 안 보일 정도로 너무 어두웠다. 수년간 찾지 못했던 답을 찾아야 하는 과제라 굉장히 난이도도 높았다. 지금에서야 보면 별거 아니지만 모든 일이 그렇지 않을까 싶다. 방법을 찾고나면 허무하지만 인사이트를 얻게되는 것, 그게 이 길의 특징 아닐까 싶다. 생각해보면 ...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/about_file_api/" class="btn btn-outline-primary" aria-label="Older" ><p><b>안드로이드 앱 실행 시 어떤 파일들에 접근할까</b></p></a> <a href="/posts/idea_for_detect_frida/" class="btn btn-outline-primary" aria-label="Newer" ><p><b>Frida 탐지 방법에 대한 고찰</b></p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://github.com/RuffaloLavoisier">Ruffalo</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p><div class='typing'>I'm <STRONG><span class="text"></span></STRONG></div><script> document.addEventListener("DOMContentLoaded", function () { const $text = document.querySelector(".typing .text"); const letters = [ "Developer", "Author", "Creator", "Inventor", "Conductor", "Traveler" ]; const speed = 100; let i = 0; const typing = async () => { const letter = letters[i].split(""); while (letter.length) { await wait(speed); $text.innerHTML += letter.shift(); } await wait(800); remove(); }; const remove = async () => { const letter = letters[i].split(""); while (letter.length) { await wait(speed); letter.pop(); $text.innerHTML = letter.join(""); } i = !letters[i + 1] ? 0 : i + 1; typing(); }; function wait(ms) { return new Promise(res => setTimeout(res, ms)) } setTimeout(typing, 1500); }); </script></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.3.0" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/research/">Research</a> <a class="post-tag btn btn-outline-primary" href="/tags/android/">Android</a> <a class="post-tag btn btn-outline-primary" href="/tags/develop/">Develop</a> <a class="post-tag btn btn-outline-primary" href="/tags/git/">Git</a> <a class="post-tag btn btn-outline-primary" href="/tags/malware/">Malware</a> <a class="post-tag btn btn-outline-primary" href="/tags/blog/">Blog</a> <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a> <a class="post-tag btn btn-outline-primary" href="/tags/mobile/">Mobile</a> <a class="post-tag btn btn-outline-primary" href="/tags/software-developer/">Software developer</a> <a class="post-tag btn btn-outline-primary" href="/tags/diary/">Diary</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><script> (function () { const origin = 'https://utteranc.es'; const themeMapper = Theme.getThemeMapper('github-light', 'github-dark'); const initTheme = themeMapper[Theme.visualState]; let script = document.createElement('script'); script.src = 'https://utteranc.es/client.js'; script.setAttribute('repo', 'RuffaloLavoisier/ruffalolavoisier.github.io'); script.setAttribute('issue-term', 'pathname'); script.setAttribute('theme', initTheme); script.crossOrigin = 'anonymous'; script.async = true; const $footer = document.querySelector('footer'); $footer.insertAdjacentElement('beforebegin', script); addEventListener('message', (event) => { let newTheme;if (event.source === window && event.data && event.data.id === Theme.ID) { newTheme = themeMapper[Theme.visualState]; const message = { type: 'set-theme', theme: newTheme }; const utterances = document.querySelector('.utterances-frame').contentWindow; utterances.postMessage(message, origin); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
