<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="ELF 실행파일에 대한 고찰 - shell" /><meta property="og:locale" content="en" /><meta name="description" content="Android License Validator" /><meta property="og:description" content="Android License Validator" /><link rel="canonical" href="https://ruffalolavoisier.github.io/posts/android_license_validator/" /><meta property="og:url" content="https://ruffalolavoisier.github.io/posts/android_license_validator/" /><meta property="og:site_name" content="Unforgettable" /><meta property="og:image" content="https://ruffalolavoisier.github.io/assets/img/common/search.webp" /><meta property="og:image:alt" content="ELF Reverse engineering" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-04-23T15:45:03+09:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://ruffalolavoisier.github.io/assets/img/common/search.webp" /><meta name="twitter:image:alt" content="ELF Reverse engineering" /><meta property="twitter:title" content="ELF 실행파일에 대한 고찰 - shell" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-06-16T07:57:29+09:00","datePublished":"2025-04-23T15:45:03+09:00","description":"Android License Validator","headline":"ELF 실행파일에 대한 고찰 - shell","image":{"lqip":"data:image/webp;base64","alt":"ELF Reverse engineering","url":"https://ruffalolavoisier.github.io/assets/img/common/search.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ruffalolavoisier.github.io/posts/android_license_validator/"},"url":"https://ruffalolavoisier.github.io/posts/android_license_validator/"}</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2677268060283942" crossorigin="anonymous"></script><title>ELF 실행파일에 대한 고찰 - shell | Unforgettable</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Unforgettable"><meta name="application-name" content="Unforgettable"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js,npm/mermaid@11.4.0/dist/mermaid.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script> <script>mermaid.initialize({startOnLoad:true});</script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="https://ruffalolavoisier.github.io/assets/img/profile/profile_new.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Unforgettable</a><p class="site-subtitle fst-italic mb-0">I wonder Why I wonder</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/project/" class="nav-link"> <i class="fa-fw fas fa-laptop-code"></i> <span>PROJECT</span> </a><li class="nav-item"> <a href="/interest/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>INTEREST</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/RuffaloLavoisier" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['RuffaloLavoisier','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://stackoverflow.com/users/17522538/ruffalo" aria-label="stack-overflow" target="_blank" rel="noopener noreferrer" > <i class="fab fa-stack-overflow"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>ELF 실행파일에 대한 고찰 - shell</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip><b>ELF 실행파일에 대한 고찰 - shell</b></h1><i></i><p class="post-desc fw-light mb-4">Android License Validator</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1745390703" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 23, 2025 </time> </span> <span> Updated <time data-ts="1750028249" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 16, 2025 </time> </span><div class="mt-3 mb-3"> <a href="https://ruffalolavoisier.github.io/assets/img/common/search.webp" class="popup img-link preview-img blur"><img data-src="https://ruffalolavoisier.github.io/assets/img/common/search.webp" alt="ELF Reverse engineering" width="1200" height="630" data-lqip="true" src="data:image/webp;base64"></a><figcaption class="text-center pt-2 pb-2">ELF Reverse engineering</figcaption></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/RuffaloLavoisier">Ruffalo</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1877 words" > <em>10 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">ELF 실행파일에 대한 고찰 - shell</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">ELF 실행파일에 대한 고찰 - shell</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><h2 id="introduction"><span class="me-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>SO 라이브러리를 살펴보면서 다각도로 분석을 진행하다가 알게 된 <code class="language-plaintext highlighter-rouge">validate</code> 라는 문제에 대하여 알게되었다.<br /> ELF 에 대한 Android Reverse Engineering 으로 제공되는 문제중 하나인데 이에 대한 write-up 을 작성해보려고 한다.</p><h3 id="what-is-that"><span class="me-2">What is that</span><a href="#what-is-that" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>이를 위해 먼저 파일을 다운받는다.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>adb push validate /data/local/tmp
validate: 1 file pushed, 0 skipped. 4.4 MB/s <span class="o">(</span>9364 bytes <span class="k">in </span>0.002s<span class="o">)</span>
</pre></table></code></div></div><p>디바이스로 파일을 배치시킨다.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>adb shell
adb/ <span class="nv">$ </span><span class="nb">cd</span> /data/local/tmp
adb/ <span class="nv">$ </span><span class="nb">chmod</span> +x validate
</pre></table></code></div></div><p>해당 파일에 대하여 실행 권한을 부여한다.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>adb/ <span class="nv">$ </span>./validate
Usage: ./validate &lt;serial&gt;
</pre></table></code></div></div><p>인자 없이 실행하면 사용법을 출력한다.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>adb/ <span class="nv">$ </span>./validate qwerty
Incorrect serial <span class="o">(</span>wrong format<span class="o">)</span><span class="nb">.</span>
</pre></table></code></div></div><p>임의의 인자를 넘기면 잘못된 format 이라고 출력한다.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>adb/ <span class="nv">$ </span>./validate &lt;Correct Serial&gt;
Entering base32_decode
Outlen <span class="o">=</span> 10
Entering check_license
Product activation passed. Congratulations!
</pre></table></code></div></div><p>올바른 인자를 넘길 경우 activation passed 라는 메세지를 보여준다.</p><h3 id="analysis"><span class="me-2">Analysis</span><a href="#analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>본격적으로 파일을 살펴보겠다.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>00000000: 7f45 4c46 0101 0100 0000 0000 0000 0000  .ELF............
00000010: 0300 2800 0100 0000 bc03 0000 3400 0000  ..<span class="o">(</span>.........4...
00000020: 2421 0000 0000 0005 3400 2000 0700 2800  <span class="nv">$!</span>......4. ...<span class="o">(</span><span class="nb">.</span>
00000030: 1600 1500 0600 0000 3400 0000 3400 0000  ........4...4...
00000040: 3400 0000 e000 0000 e000 0000 0400 0000  4...............
</pre></table></code></div></div><p>맨 위는 ELF header 인데 그중 offset 0x18 ~ 0x1B 까지가 entry point 에 대한 start address 를 나타낸다.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>ELF Header:
  Magic:   7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00
  Class:                             ELF32
  Data:                              2<span class="s1">'s complement, little endian
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI Version:                       0
  Type:                              DYN (Shared object file)
  Machine:                           ARM
  Version:                           0x1
  Entry point address:               0x3bc    &lt; -----------
  Start of program headers:          52 (bytes into file)
  Start of section headers:          8484 (bytes into file)
  Flags:                             0x5000000, Version5 EABI
  Size of this header:               52 (bytes)
  Size of program headers:           32 (bytes)
  Number of program headers:         7
  Size of section headers:           40 (bytes)
  Number of section headers:         22
  Section header string table index: 21
</span></pre></table></code></div></div><p>시작 주소는 <code class="language-plaintext highlighter-rouge">0x3bc</code> 로 확인된다.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="kt">void</span> <span class="n">processEntry</span> <span class="nf">entry</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="p">{</span>
  <span class="n">dword</span> <span class="o">*</span><span class="n">local_18</span><span class="p">;</span>
  <span class="n">dword</span> <span class="o">*</span><span class="n">local_14</span><span class="p">;</span>
  <span class="n">dword</span> <span class="o">*</span><span class="n">local_10</span><span class="p">;</span>
  <span class="n">dword</span> <span class="o">*</span><span class="n">local_c</span><span class="p">;</span>
  
  <span class="n">local_18</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">__DT_PREINIT_ARRAY</span><span class="p">;</span>
  <span class="n">local_14</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">__DT_INIT_ARRAY</span><span class="p">;</span>
  <span class="n">local_10</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">__DT_FINI_ARRAY</span><span class="p">;</span>
  <span class="n">local_c</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">DWORD_00012eb4</span><span class="p">;</span>
  <span class="n">__libc_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">stack0x00000000</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">FUN_00011874</span><span class="p">,</span><span class="o">&amp;</span><span class="n">local_18</span><span class="p">);</span>
  <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>실제 어셈블리를 봤을 때 <code class="language-plaintext highlighter-rouge">0x3BC</code> 에 가보면 위와 같이 실행하는 코드를 확인할 수 있다. <code class="language-plaintext highlighter-rouge">FUN_00011874</code> 를 들어가본다.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="n">undefined4</span> <span class="nf">FUN_00011874</span><span class="p">(</span><span class="kt">int</span> <span class="n">param_1</span><span class="p">,</span><span class="kt">int</span> <span class="n">param_2</span><span class="p">)</span>

<span class="p">{</span>
  <span class="kt">size_t</span> <span class="n">sVar1</span><span class="p">;</span>
  <span class="n">undefined4</span> <span class="n">out_length</span><span class="p">;</span>
  <span class="n">undefined1</span> <span class="n">auStack_18</span> <span class="p">[</span><span class="mi">16</span><span class="p">];</span>
  
  <span class="k">if</span> <span class="p">(</span><span class="n">param_1</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">print_usage</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="n">sVar1</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">**</span><span class="p">)(</span><span class="n">param_2</span> <span class="o">+</span> <span class="mi">4</span><span class="p">));</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">sVar1</span> <span class="o">!=</span> <span class="mh">0x10</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">print_format_len</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"Entering base32_decode"</span><span class="p">);</span>
  <span class="n">FUN_00011340</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">*</span><span class="p">(</span><span class="n">undefined4</span> <span class="o">*</span><span class="p">)(</span><span class="n">param_2</span> <span class="o">+</span> <span class="mi">4</span><span class="p">),</span><span class="mh">0x10</span><span class="p">,</span><span class="n">auStack_18</span><span class="p">,</span><span class="o">&amp;</span><span class="n">out_length</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"Outlen = %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">out_length</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"Entering check_license"</span><span class="p">);</span>
  <span class="n">FUN_00011760</span><span class="p">(</span><span class="n">auStack_18</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>매개변수 갯수를 확인하고 넘어온 매개변수의 길이를 확인한다. 그리고 규격이 아닐 경우 다른 함수콜로 넘어간다.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">print_usage</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="p">{</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"Usage: ./validate &lt;serial&gt;"</span><span class="p">);</span>
  <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>사용방법을 호출힌 후 exit 하는 경우가 있으며</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">print_format_len</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="p">{</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"Incorrect serial (wrong format)."</span><span class="p">);</span>
  <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>매개변수의 길이에 대한 오류를 출력하고 exit 하는 경우도 있다.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
</pre><td class="rouge-code"><pre><span class="n">bool</span> <span class="nf">FUN_00011340</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="n">p_0</span><span class="p">,</span><span class="kt">char</span> <span class="o">*</span><span class="n">arg_string</span><span class="p">,</span><span class="n">uint</span> <span class="mh">0x10</span><span class="n">_value</span><span class="p">,</span><span class="kt">int</span> <span class="n">param_4</span><span class="p">,</span><span class="kt">int</span> <span class="o">*</span><span class="n">p_out_length</span><span class="p">)</span>

<span class="p">{</span>
  <span class="kt">char</span> <span class="n">cVar1</span><span class="p">;</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">piVar2</span><span class="p">;</span>
  <span class="n">uint</span> <span class="n">uVar3</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">local_38</span><span class="p">;</span>
  <span class="n">uint</span> <span class="n">local_34</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">local_30</span><span class="p">;</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">local_2c</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">local_out_len</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">local_20</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">local_19</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">local_18</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">local_14</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">local_10</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">local_9</span><span class="p">;</span>
  
  <span class="n">local_out_len</span> <span class="o">=</span> <span class="o">*</span><span class="n">p_out_length</span><span class="p">;</span>
  <span class="n">piVar2</span> <span class="o">=</span> <span class="n">p_0</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">p_0</span> <span class="o">==</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">piVar2</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">local_19</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="n">piVar2</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">p_0</span> <span class="o">!=</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">local_19</span> <span class="o">=</span> <span class="sc">'\x01'</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">local_9</span> <span class="o">=</span> <span class="sc">'\0'</span><span class="p">;</span>
  <span class="n">local_10</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">local_38</span> <span class="o">=</span> <span class="n">param_4</span><span class="p">;</span>
  <span class="n">local_34</span> <span class="o">=</span> <span class="mh">0x10</span><span class="n">_value</span><span class="p">;</span>
  <span class="n">local_30</span> <span class="o">=</span> <span class="n">arg_string</span><span class="p">;</span>
  <span class="n">local_2c</span> <span class="o">=</span> <span class="n">p_0</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">local_19</span> <span class="o">!=</span> <span class="sc">'\0'</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">local_10</span> <span class="o">=</span> <span class="o">*</span><span class="n">p_0</span><span class="p">;</span>
    <span class="n">uVar3</span> <span class="o">=</span> <span class="mh">0x10</span><span class="n">_value</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="mh">0x10</span><span class="n">_value</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">uVar3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">local_9</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="n">uVar3</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="mh">0x10</span><span class="n">_value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">local_9</span> <span class="o">=</span> <span class="sc">'\x01'</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">while</span><span class="p">(</span> <span class="nb">true</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">while</span><span class="p">(</span> <span class="nb">true</span> <span class="p">)</span> <span class="p">{</span>
      <span class="n">local_14</span> <span class="o">=</span> <span class="n">local_out_len</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">((</span><span class="n">local_10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">local_9</span> <span class="o">!=</span> <span class="sc">'\x01'</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">while</span><span class="p">(</span> <span class="nb">true</span> <span class="p">)</span> <span class="p">{</span>
          <span class="n">local_14</span> <span class="o">=</span> <span class="n">local_out_len</span><span class="p">;</span>
          <span class="n">cVar1</span> <span class="o">=</span> <span class="n">FUN_00010c08</span><span class="p">(</span><span class="n">local_30</span><span class="p">,</span><span class="n">local_34</span><span class="p">,</span><span class="o">&amp;</span><span class="n">local_38</span><span class="p">,</span><span class="o">&amp;</span><span class="n">local_out_len</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">cVar1</span> <span class="o">!=</span> <span class="sc">'\x01'</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
          <span class="n">local_30</span> <span class="o">=</span> <span class="n">local_30</span> <span class="o">+</span> <span class="mi">8</span><span class="p">;</span>
          <span class="n">local_34</span> <span class="o">=</span> <span class="n">local_34</span> <span class="o">-</span> <span class="mi">8</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">((</span><span class="n">local_34</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">local_9</span> <span class="o">!=</span> <span class="sc">'\x01'</span><span class="p">))</span> <span class="k">goto</span> <span class="n">_EXIT</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">((</span><span class="n">local_34</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">||</span> <span class="p">((</span><span class="o">*</span><span class="n">local_30</span> <span class="o">!=</span> <span class="sc">'\n'</span> <span class="o">||</span> <span class="p">(</span><span class="n">local_19</span> <span class="o">==</span> <span class="sc">'\0'</span><span class="p">))))</span> <span class="k">break</span><span class="p">;</span>
      <span class="n">local_30</span> <span class="o">=</span> <span class="n">local_30</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
      <span class="n">local_34</span> <span class="o">=</span> <span class="n">local_34</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">local_38</span> <span class="o">=</span> <span class="n">local_38</span> <span class="o">+</span> <span class="p">(</span><span class="n">local_out_len</span> <span class="o">-</span> <span class="n">local_14</span><span class="p">);</span>
    <span class="n">local_out_len</span> <span class="o">=</span> <span class="n">local_14</span><span class="p">;</span>
    <span class="n">local_20</span> <span class="o">=</span> <span class="n">local_30</span> <span class="o">+</span> <span class="n">local_34</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">local_19</span> <span class="o">==</span> <span class="sc">'\0'</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">local_18</span> <span class="o">=</span> <span class="n">local_30</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="n">local_18</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">FUN_00010aa8</span><span class="p">(</span><span class="n">local_2c</span><span class="p">,</span><span class="o">&amp;</span><span class="n">local_30</span><span class="p">,</span><span class="n">local_20</span><span class="p">,</span><span class="o">&amp;</span><span class="n">local_34</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">local_34</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">||</span> <span class="p">(((</span><span class="n">local_34</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">local_9</span> <span class="o">!=</span> <span class="sc">'\x01'</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">local_19</span> <span class="o">!=</span> <span class="sc">'\0'</span><span class="p">))))</span> <span class="k">break</span><span class="p">;</span>
    <span class="n">cVar1</span> <span class="o">=</span> <span class="n">FUN_00010c08</span><span class="p">(</span><span class="n">local_18</span><span class="p">,</span><span class="n">local_34</span><span class="p">,</span><span class="o">&amp;</span><span class="n">local_38</span><span class="p">,</span><span class="o">&amp;</span><span class="n">local_out_len</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">cVar1</span> <span class="o">!=</span> <span class="sc">'\x01'</span><span class="p">)</span> <span class="k">goto</span> <span class="n">_EXIT</span><span class="p">;</span>
    <span class="n">local_34</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">local_20</span> <span class="o">-</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">local_30</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">local_34</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nl">_EXIT:</span>
  <span class="o">*</span><span class="n">p_out_length</span> <span class="o">=</span> <span class="o">*</span><span class="n">p_out_length</span> <span class="o">-</span> <span class="n">local_out_len</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">local_34</span> <span class="o">==</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">FUN_00011340</code> 를 살펴보면 문자열에 대한 조합을 진행하는 것으로 보인다. OUT_PARAM 으로 <code class="language-plaintext highlighter-rouge">p_out_length</code> 에 주소를 넣는걸 볼 수 있다.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">FUN_00011760</span><span class="p">(</span><span class="n">byte</span> <span class="o">*</span><span class="n">param_1</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">uint</span> <span class="n">uVar1</span><span class="p">;</span>
  <span class="n">byte</span> <span class="n">local_20</span> <span class="p">[</span><span class="mi">8</span><span class="p">];</span>
  <span class="kt">int</span> <span class="n">local_18</span><span class="p">;</span>
  <span class="n">byte</span> <span class="o">*</span><span class="n">local_14</span><span class="p">;</span>
  
  <span class="n">local_14</span> <span class="o">=</span> <span class="n">param_1</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">local_18</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">local_18</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="n">local_18</span> <span class="o">=</span> <span class="n">local_18</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">local_20</span><span class="p">[</span><span class="n">local_18</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">local_14</span> <span class="o">^</span> <span class="n">local_14</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="n">local_14</span> <span class="o">=</span> <span class="n">local_14</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">uVar1</span> <span class="o">=</span> <span class="n">FUN_000116f0</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">((((</span><span class="n">local_20</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">uVar1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">uVar1</span> <span class="o">=</span> <span class="n">FUN_0001170c</span><span class="p">(),</span> <span class="n">local_20</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">uVar1</span><span class="p">))</span> <span class="o">&amp;&amp;</span>
      <span class="p">(</span><span class="n">uVar1</span> <span class="o">=</span> <span class="n">FUN_000116f0</span><span class="p">(),</span> <span class="n">local_20</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">uVar1</span><span class="p">))</span> <span class="o">&amp;&amp;</span>
     <span class="p">((</span><span class="n">uVar1</span> <span class="o">=</span> <span class="n">FUN_00011728</span><span class="p">(),</span> <span class="n">local_20</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">uVar1</span> <span class="o">&amp;&amp;</span>
      <span class="p">(</span><span class="n">uVar1</span> <span class="o">=</span> <span class="n">FUN_00011744</span><span class="p">(),</span> <span class="n">local_20</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="n">uVar1</span><span class="p">))))</span> <span class="p">{</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"Product activation passed. Congratulations!"</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"Incorrect serial."</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">FUN_00011760</code> 에서는 xor 연산을 진행한 뒤 다음 코드에서 하위적으로 조건을 확인한 다음 올바른 조건일 경우 <code class="language-plaintext highlighter-rouge">Product activation passed. Congratulations!</code> 라는 메세지를 그렇지 않을 경우 <code class="language-plaintext highlighter-rouge">Incorrect serial.</code> 라는 메세지를 출력한다.</p><p><a href="https://ruffalolavoisier.github.io/assets/img/2025-04-11-android_license_validator/2025-04-24-11-29-46.png" class="popup img-link shimmer"><img src="https://ruffalolavoisier.github.io/assets/img/2025-04-11-android_license_validator/2025-04-24-11-29-46.png" alt="" class="shadow" loading="lazy"></a> <em>Call Flow for addr</em></p><p>함수 호출 시(0x1760) <code class="language-plaintext highlighter-rouge">Product activation passed. Congratulations!</code> 메시지를 출력하는 부분과(0x1840) <code class="language-plaintext highlighter-rouge">Incorrect serial.</code> 메세지를 출력하는 부분을(0x1854) 볼 수 있다.</p><p>눈치 챘을 수 있지만 조건문에서 필터링 하는 것을 보아 키는 하나만 가능한 것이 아니라 여러가지의 경우의 수가 다 만족할 수 있어 보인다.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>
                  { . . . }

        00011840 24 30 9f e5     ldr        r3,[DAT_0001186c]                                = 00000270h
        00011844 03 30 8f e0     add        r3=&gt;s_Product_activation_passed._Congr_00011ab   = "Product activation passed. Co
        00011848 03 00 a0 e1     cpy        r0=&gt;s_Product_activation_passed._Congr_00011ab   = "Product activation passed. Co
        0001184c c9 fa ff eb     bl         &lt;EXTERNAL&gt;::puts                                 int puts(char * __s)
        00011850 03 00 00 ea     b          LAB_00011864
                             LAB_00011854                                    XREF[5]:     000117ec(j), 00011800(j), 
                                                                                          00011814(j), 00011828(j), 
                                                                                          0001183c(j)  
        00011854 14 30 9f e5     ldr        r3,[DAT_00011870]                                = 00000288h
        00011858 03 30 8f e0     add        r3=&gt;s_Incorrect_serial._00011ae8,pc,r3           = "Incorrect serial."
        0001185c 03 00 a0 e1     cpy        r0=&gt;s_Incorrect_serial._00011ae8,r3              = "Incorrect serial."
        00011860 c4 fa ff eb     bl         &lt;EXTERNAL&gt;::puts                                 int puts(char * __s)
                             LAB_00011864                                    XREF[1]:     00011850(j)  
        00011864 08 d0 4b e2     sub        sp,r11,#0x8

                  { . . . }
                  
</pre></table></code></div></div><p>이를 바이너리 위에서 보면 위와 같다.</p><h2 id="the-game-changer"><span class="me-2">The Game-Changer</span><a href="#the-game-changer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>이는 script 로 작성하여 진행하면 실행중에 나타날 수 있는 메모리 값을 Symbolic Execution 통해 유츄해볼 수 있다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">code_state</span> <span class="o">=</span> <span class="n">binary</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="nf">blank_state</span><span class="p">(</span><span class="n">addr</span><span class="o">=</span><span class="mh">0x401760</span><span class="p">,</span> <span class="n">add_options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
</pre></table></code></div></div><p>현재 실행하는 함수에 대한 시작 주소를 설정한다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">code_flow</span> <span class="o">=</span> <span class="n">binary</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="nf">simulation_manager</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="n">code_flow</span><span class="p">.</span><span class="nf">explore</span><span class="p">(</span><span class="n">find</span><span class="o">=</span><span class="mh">0x401840</span><span class="p">,</span> <span class="n">avoid</span><span class="o">=</span><span class="mh">0x401854</span><span class="p">)</span>
</pre></table></code></div></div><p>위에서 찾았던 passed 메세지와 Incorrect 메세지에 대한 offset addr 을 넣어준다.</p><p>그러면 실행했을 때 아래와 같은 문자열을 취득할 수 있다.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>b<span class="s1">'BRAE6AAMIBNAAIIA'</span>
</pre></table></code></div></div><p>이때 찾아낸 문자열을 통하여 인자로 넘겨준다.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cd</span> /data/local/tmp
<span class="nv">$ </span>./validate BRAE6AAMIBNAAIIA
Entering base32_decode
Outlen <span class="o">=</span> 10
Entering check_license
Product activation passed. Congratulations!
</pre></table></code></div></div><p>그리하면 위와 같이 키를 찾아낸 걸 볼 수 있다.</p><h2 id="conclusion"><span class="me-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>ELF 파일은 알면 알수록 흥미로운 대상이다. 디버깅이나 이슈 처리는 상당히 어렵지만 그만큼 탄탄하게 구조를 잡고 간다면 내부적으로는 강력한 실행 구조를 외부적으로 강인한 제품을 얻게되는 셈이다.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/research/">Research</a>, <a href="/categories/security/">Security</a>, <a href="/categories/malware/">Malware</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/security/" class="post-tag no-text-decoration" >Security</a> <a href="/tags/research/" class="post-tag no-text-decoration" >Research</a> <a href="/tags/malware/" class="post-tag no-text-decoration" >Malware</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author. <br>If you find any errors, please let me know by comment or email. Thank you.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=ELF%20%EC%8B%A4%ED%96%89%ED%8C%8C%EC%9D%BC%EC%97%90%20%EB%8C%80%ED%95%9C%20%EA%B3%A0%EC%B0%B0%20-%20shell%20-%20Unforgettable&url=https%3A%2F%2Fruffalolavoisier.github.io%2Fposts%2Fandroid_license_validator%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=ELF%20%EC%8B%A4%ED%96%89%ED%8C%8C%EC%9D%BC%EC%97%90%20%EB%8C%80%ED%95%9C%20%EA%B3%A0%EC%B0%B0%20-%20shell%20-%20Unforgettable&u=https%3A%2F%2Fruffalolavoisier.github.io%2Fposts%2Fandroid_license_validator%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fruffalolavoisier.github.io%2Fposts%2Fandroid_license_validator%2F&text=ELF%20%EC%8B%A4%ED%96%89%ED%8C%8C%EC%9D%BC%EC%97%90%20%EB%8C%80%ED%95%9C%20%EA%B3%A0%EC%B0%B0%20-%20shell%20-%20Unforgettable" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/factory_reset_and_dell_charger_is_not_working/">공장 초기화 후 DELL 노트북 충전기의 동작에 관하여</a><li class="text-truncate lh-lg"> <a href="/posts/gitlab-with-slack/">Slack 에 웹훅(webhook) 연결하기</a><li class="text-truncate lh-lg"> <a href="/posts/vpn_from_freerdp_on_mac/">How to use VPN client on macOS ?</a><li class="text-truncate lh-lg"> <a href="/posts/bypass_rasp/">RASP 에 대한 고찰</a><li class="text-truncate lh-lg"> <a href="/posts/OSW/">Open smartwatch Contribution</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/research/">Research</a> <a class="post-tag btn btn-outline-primary" href="/tags/android/">Android</a> <a class="post-tag btn btn-outline-primary" href="/tags/develop/">Develop</a> <a class="post-tag btn btn-outline-primary" href="/tags/git/">Git</a> <a class="post-tag btn btn-outline-primary" href="/tags/malware/">Malware</a> <a class="post-tag btn btn-outline-primary" href="/tags/blog/">Blog</a> <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a> <a class="post-tag btn btn-outline-primary" href="/tags/mobile/">Mobile</a> <a class="post-tag btn btn-outline-primary" href="/tags/software-developer/">Software developer</a> <a class="post-tag btn btn-outline-primary" href="/tags/diary/">Diary</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/elf_header_analysis/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1745482084" data-df="ll" > Apr 24, 2025 </time><h4 class="pt-0 my-2"><b>ELF header 에 대한 고찰</b></h4><div class="text-muted"><p>ELF header 살펴보기</p></div></div></a></article><article class="col"> <a href="/posts/detect-screencapture/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1708095600" data-df="ll" > Feb 17, 2024 </time><h4 class="pt-0 my-2"><b>사용자의 행동을 감시하는 코드 - screen capture</b></h4><div class="text-muted"><p>Step by step 최근에 특이한 코드가 눈에 보여 따라가다가 굉장히 재밌는 패턴을 발견하여 해당 코드에 대해 정리해보려고 한다. 사용자의 파일과 액티비티 전환에 따른 결과를 보고 해당 파일을 특정 서버로 전송하는 코드이다. 코드 분석 근래 파일 관찰자와 액티비티 화면 전환을 통하여 최근 디바이스에서 캡쳐한 사진을 확인하는 코드가 발견되었다...</p></div></div></a></article><article class="col"> <a href="/posts/malware_analysis_a_encrypted_string/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1743533997" data-df="ll" > Apr 2, 2025 </time><h4 class="pt-0 my-2"><b>동적으로 로드되는 실행 파일에 대한 고찰 - 3</b></h4><div class="text-muted"><p>malware analysis a encrypted string</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/apkid_for_device/" class="btn btn-outline-primary" aria-label="Older" ><p><b>APKiD for Device</b></p></a> <a href="/posts/elf_header_analysis/" class="btn btn-outline-primary" aria-label="Newer" ><p><b>ELF header 에 대한 고찰</b></p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://github.com/RuffaloLavoisier">Ruffalo</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p><div class='typing'>I'm <STRONG><span class="text"></span></STRONG></div><script> document.addEventListener("DOMContentLoaded", function () { const $text = document.querySelector(".typing .text"); const letters = [ "Developer", "Author", "Creator", "Inventor", "Conductor", "Traveler" ]; const speed = 100; let i = 0; const typing = async () => { const letter = letters[i].split(""); while (letter.length) { await wait(speed); $text.innerHTML += letter.shift(); } await wait(800); remove(); }; const remove = async () => { const letter = letters[i].split(""); while (letter.length) { await wait(speed); letter.pop(); $text.innerHTML = letter.join(""); } i = !letters[i + 1] ? 0 : i + 1; typing(); }; function wait(ms) { return new Promise(res => setTimeout(res, ms)) } setTimeout(typing, 1500); }); </script></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.3.0" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/research/">Research</a> <a class="post-tag btn btn-outline-primary" href="/tags/android/">Android</a> <a class="post-tag btn btn-outline-primary" href="/tags/develop/">Develop</a> <a class="post-tag btn btn-outline-primary" href="/tags/git/">Git</a> <a class="post-tag btn btn-outline-primary" href="/tags/malware/">Malware</a> <a class="post-tag btn btn-outline-primary" href="/tags/blog/">Blog</a> <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a> <a class="post-tag btn btn-outline-primary" href="/tags/mobile/">Mobile</a> <a class="post-tag btn btn-outline-primary" href="/tags/software-developer/">Software developer</a> <a class="post-tag btn btn-outline-primary" href="/tags/diary/">Diary</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><script> (function () { const origin = 'https://utteranc.es'; const themeMapper = Theme.getThemeMapper('github-light', 'github-dark'); const initTheme = themeMapper[Theme.visualState]; let script = document.createElement('script'); script.src = 'https://utteranc.es/client.js'; script.setAttribute('repo', 'RuffaloLavoisier/ruffalolavoisier.github.io'); script.setAttribute('issue-term', 'pathname'); script.setAttribute('theme', initTheme); script.crossOrigin = 'anonymous'; script.async = true; const $footer = document.querySelector('footer'); $footer.insertAdjacentElement('beforebegin', script); addEventListener('message', (event) => { let newTheme;if (event.source === window && event.data && event.data.id === Theme.ID) { newTheme = themeMapper[Theme.visualState]; const message = { type: 'set-theme', theme: newTheme }; const utterances = document.querySelector('.utterances-frame').contentWindow; utterances.postMessage(message, origin); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
