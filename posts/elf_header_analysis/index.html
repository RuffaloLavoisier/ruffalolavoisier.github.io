<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="ELF header 에 대한 고찰" /><meta property="og:locale" content="en" /><meta name="description" content="ELF header 살펴보기" /><meta property="og:description" content="ELF header 살펴보기" /><link rel="canonical" href="https://ruffalolavoisier.github.io/posts/elf_header_analysis/" /><meta property="og:url" content="https://ruffalolavoisier.github.io/posts/elf_header_analysis/" /><meta property="og:site_name" content="Unforgettable" /><meta property="og:image" content="https://ruffalolavoisier.github.io/assets/img/common/android_binary.webp" /><meta property="og:image:alt" content="UPX-DEC 카테고리가 적용된 ELF 파일들의 대한 header 분석" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-04-24T17:08:04+09:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://ruffalolavoisier.github.io/assets/img/common/android_binary.webp" /><meta name="twitter:image:alt" content="UPX-DEC 카테고리가 적용된 ELF 파일들의 대한 header 분석" /><meta property="twitter:title" content="ELF header 에 대한 고찰" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-06-16T07:57:29+09:00","datePublished":"2025-04-24T17:08:04+09:00","description":"ELF header 살펴보기","headline":"ELF header 에 대한 고찰","image":{"lqip":"data:image/webp;base64","alt":"UPX-DEC 카테고리가 적용된 ELF 파일들의 대한 header 분석","url":"https://ruffalolavoisier.github.io/assets/img/common/android_binary.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ruffalolavoisier.github.io/posts/elf_header_analysis/"},"url":"https://ruffalolavoisier.github.io/posts/elf_header_analysis/"}</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2677268060283942" crossorigin="anonymous"></script><title>ELF header 에 대한 고찰 | Unforgettable</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Unforgettable"><meta name="application-name" content="Unforgettable"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js,npm/mermaid@11.4.0/dist/mermaid.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script> <script>mermaid.initialize({startOnLoad:true});</script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="https://ruffalolavoisier.github.io/assets/img/profile/profile_refactor.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Unforgettable</a><p class="site-subtitle fst-italic mb-0">I wonder Why I wonder</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/project/" class="nav-link"> <i class="fa-fw fas fa-laptop-code"></i> <span>PROJECT</span> </a><li class="nav-item"> <a href="/interest/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>INTEREST</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/RuffaloLavoisier" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['RuffaloLavoisier','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://stackoverflow.com/users/17522538/ruffalo" aria-label="stack-overflow" target="_blank" rel="noopener noreferrer" > <i class="fab fa-stack-overflow"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>ELF header 에 대한 고찰</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip><b>ELF header 에 대한 고찰</b></h1><i></i><p class="post-desc fw-light mb-4">ELF header 살펴보기</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1745482084" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 24, 2025 </time> </span> <span> Updated <time data-ts="1750028249" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 16, 2025 </time> </span><div class="mt-3 mb-3"> <a href="https://ruffalolavoisier.github.io/assets/img/common/android_binary.webp" class="popup img-link preview-img blur"><img data-src="https://ruffalolavoisier.github.io/assets/img/common/android_binary.webp" alt="UPX-DEC 카테고리가 적용된 ELF 파일들의 대한 header 분석" width="1200" height="630" data-lqip="true" src="data:image/webp;base64"></a><figcaption class="text-center pt-2 pb-2">UPX-DEC 카테고리가 적용된 ELF 파일들의 대한 header 분석</figcaption></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/RuffaloLavoisier">Ruffalo</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="846 words" > <em>4 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">ELF header 에 대한 고찰</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">ELF header 에 대한 고찰</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><h2 id="introduction"><span class="me-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Android 네이티브 바이너리를 분석해보면서 ELF Malware 에서는 UPX-DEC 의 실행압축이 적용된 바이너리들이 있다. 이때 자세히 살펴본 elf file (header) format layout 을 정리해본다.</p><p>hex 에서 보면 64 비트 elf 에 대한 헤더는 아래와 같다.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>00000000: 7f45 4c46 0201 0100 0000 0000 0000 0000  .ELF............
00000010: 0300 b700 0100 0000 0000 0000 0000 0000  ................
00000020: 4000 0000 0000 0000 7043 0000 0000 0000  @.......pC......
00000030: 0000 0000 4000 3800 0900 4000 1900 1800  ....@.8...@.....
</pre></table></code></div></div><p>32 비트 elf 에 대한 헤더는 아래와 같다.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>00000000: 7f45 4c46 0101 0100 0000 0000 0000 0000  .ELF............
00000010: 0300 0300 0100 0000 0000 0000 3400 0000  ............4...
00000020: 8c46 0000 0000 0000 3400 2000 0a00 2800  .F......4. ...(.
00000030: 1900 1800                                ....
</pre></table></code></div></div><p>비슷해보이지만 64 bit 는 0x40 32 bit 는 0x34 크기로 총 12 bytes 의 차이가 있다.</p><p>그러면 하나하나 보면서 어디가 어떻게 다른지 살펴보며 헤더 파일을 정리해보겠다.</p><h2 id="elf-header"><span class="me-2">ELF header</span><a href="#elf-header" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>elf_header:40h/34h struct The main elf header basically tells us where everything is located in the file.</p><p>32 bit 에서는 0x34, 64 bit 에서는 0x40 의 크기를 가지고 있다.</p><blockquote><p>모든 항목은 <code class="language-plaintext highlighter-rouge">항목이름:사이즈(hex)</code> 로 표기하였다.</p></blockquote><h3 id="e_ident"><span class="me-2">e_ident</span><a href="#e_ident" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>e_ident:10h
</pre></table></code></div></div><p>ELF 객체를 식별하는 16바이트 배열이며, 항상 “\x7fELF”로 시작한다. 파일 매직 이외 다른 정보도 포함하고 있다.</p><h4 id="file_identification"><span class="me-2">file_identification[]</span><a href="#file_identification" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>file_identification[4]:4h
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">\x7fELF</code> 라는 고정된 시그니처를 가지고 있다.</p><h4 id="ei_class_2"><span class="me-2">ei_class_2</span><a href="#ei_class_2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ei_class_2:1h
</pre></table></code></div></div><p>64 bit 인지 32 bit 인지 확인할 수 있다.</p><h4 id="ei_data"><span class="me-2">ei_data</span><a href="#ei_data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ei_data:1h
</pre></table></code></div></div><p>BE 과 LE 를 구분하기 위한 방식.</p><h4 id="ei_version"><span class="me-2">ei_version</span><a href="#ei_version" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ei_version:1h
</pre></table></code></div></div><p>ELF 파일 형식의 버전 번호.</p><h4 id="ei_osabi"><span class="me-2">ei_osabi</span><a href="#ei_osabi" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ei_osabi:1h
</pre></table></code></div></div><p>파일을 사용할 수 있는 운영체제에 대한 정보.</p><h4 id="ei_abiversion"><span class="me-2">ei_abiversion</span><a href="#ei_abiversion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ei_abiversion:1h
</pre></table></code></div></div><p>ELF 파일을 실행할 수 있는 API 버전.</p><h4 id="ei_pad"><span class="me-2">ei_pad[]</span><a href="#ei_pad" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ei_pad[6]:6h
</pre></table></code></div></div><p>패딩 비트.</p><h4 id="ei_nident_size"><span class="me-2">ei_nident_SIZE</span><a href="#ei_nident_size" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ei_nident_SIZE:1h
</pre></table></code></div></div><p>추가적인 정보가 없지만 1 Bytes 를 차지하고 있다.</p><h3 id="e_type"><span class="me-2">e_type</span><a href="#e_type" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>e_type:2h
</pre></table></code></div></div><p>ELF 유형을 지정.</p><h3 id="e_machine"><span class="me-2">e_machine</span><a href="#e_machine" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>e_machine:2h
</pre></table></code></div></div><p>타겟 아키텍처.</p><h3 id="e_version"><span class="me-2">e_version</span><a href="#e_version" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>e_version:4h
</pre></table></code></div></div><p>ELF 파일 버전.</p><h3 id="아키텍쳐에서-다른-부분-e_entry-e_phoff-e_shoff"><span class="me-2">아키텍쳐에서 다른 부분 (e_entry, e_phoff, e_shoff)</span><a href="#아키텍쳐에서-다른-부분-e_entry-e_phoff-e_shoff" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>이 부분에서 64 bit 와 32 bit 간 차이가 있다. 64 bit 에서는 3가지 항목 필드가 각각 0x8 이지만 32 bit 에서는 0x4 이다.</p><p>따라서 3가지 항목 크기 차이는 0x4 * 3 = 0xC (12 bytes), 64 bit 헤더 크기(0x40) - 32 bit 헤더 크기(0x34) = 0xC 이다.</p><h4 id="64-bit"><span class="me-2">64 bit</span><a href="#64-bit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><h4 id="e_entry_start_address"><span class="me-2">e_entry_START_ADDRESS</span><a href="#e_entry_start_address" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>e_entry_START_ADDRESS:8h
</pre></table></code></div></div><p>진입점 주소.</p><h4 id="e_phoff_program_header_offset_in_file"><span class="me-2">e_phoff_PROGRAM_HEADER_OFFSET_IN_FILE</span><a href="#e_phoff_program_header_offset_in_file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>e_phoff_PROGRAM_HEADER_OFFSET_IN_FILE:8h
</pre></table></code></div></div><p>Program header 오프셋.</p><h4 id="e_shoff_section_header_offset_in_file"><span class="me-2">e_shoff_SECTION_HEADER_OFFSET_IN_FILE</span><a href="#e_shoff_section_header_offset_in_file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>e_shoff_SECTION_HEADER_OFFSET_IN_FILE:8h
</pre></table></code></div></div><p>Section header 오프셋.</p><h4 id="32-bit"><span class="me-2">32 bit</span><a href="#32-bit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><h4 id="e_entry_start_address-1"><span class="me-2">e_entry_START_ADDRESS</span><a href="#e_entry_start_address-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>e_entry_START_ADDRESS:4h
</pre></table></code></div></div><p>진입점 주소.</p><h4 id="e_phoff_program_header_offset_in_file-1"><span class="me-2">e_phoff_PROGRAM_HEADER_OFFSET_IN_FILE</span><a href="#e_phoff_program_header_offset_in_file-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>e_phoff_PROGRAM_HEADER_OFFSET_IN_FILE:4h
</pre></table></code></div></div><p>Program header 오프셋.</p><h4 id="e_shoff_section_header_offset_in_file-1"><span class="me-2">e_shoff_SECTION_HEADER_OFFSET_IN_FILE</span><a href="#e_shoff_section_header_offset_in_file-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>e_shoff_SECTION_HEADER_OFFSET_IN_FILE:4h
</pre></table></code></div></div><p>Section header 오프셋.</p><h3 id="e_flags"><span class="me-2">e_flags</span><a href="#e_flags" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>e_flags:4h
</pre></table></code></div></div><p>프로세서별 플래그.</p><h3 id="e_ehsize_elf_header_size"><span class="me-2">e_ehsize_ELF_HEADER_SIZE</span><a href="#e_ehsize_elf_header_size" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>e_ehsize_ELF_HEADER_SIZE:2h
</pre></table></code></div></div><p>e_ehsizeEHDR 크기(바이트), 일반적으로 64비트 ELF에서는 64바이트, 32비트에서는 52바이트.</p><h3 id="e_phentsize_program_header_entry_size_in_file"><span class="me-2">e_phentsize_PROGRAM_HEADER_ENTRY_SIZE_IN_FILE</span><a href="#e_phentsize_program_header_entry_size_in_file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>e_phentsize_PROGRAM_HEADER_ENTRY_SIZE_IN_FILE:2h
</pre></table></code></div></div><p>프로그램 헤더 학위 항목 크기.</p><h3 id="e_phnum_number_of_program_header_entries"><span class="me-2">e_phnum_NUMBER_OF_PROGRAM_HEADER_ENTRIES</span><a href="#e_phnum_number_of_program_header_entries" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>e_phnum_NUMBER_OF_PROGRAM_HEADER_ENTRIES:2h
</pre></table></code></div></div><p>프로그램 헤더 학위 항목 갯수.</p><h3 id="e_shentsize_section_header_entry_size"><span class="me-2">e_shentsize_SECTION_HEADER_ENTRY_SIZE</span><a href="#e_shentsize_section_header_entry_size" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>e_shentsize_SECTION_HEADER_ENTRY_SIZE:2h
</pre></table></code></div></div><p>Section header 엔트리 크기.</p><h3 id="e_shnum_number_of_section_header_entries"><span class="me-2">e_shnum_NUMBER_OF_SECTION_HEADER_ENTRIES</span><a href="#e_shnum_number_of_section_header_entries" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>e_shnum_NUMBER_OF_SECTION_HEADER_ENTRIES:2h
</pre></table></code></div></div><p>Section header 항목 갯수.</p><h3 id="e_shtrndx_string_table_index"><span class="me-2">e_shtrndx_STRING_TABLE_INDEX</span><a href="#e_shtrndx_string_table_index" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>e_shtrndx_STRING_TABLE_INDEX:2h
</pre></table></code></div></div><p>Section header 문자열 테이블 인덱스( .shstrtab각 섹션의 이름이 있는 null로 끝나는 문자열을 포함함)</p><h2 id="conclusion"><span class="me-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>다음에 기회가 되면 ELF 를 실제로 수정해보는 작업을 진행해보겠다.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/research/">Research</a>, <a href="/categories/malware/">Malware</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/malware/" class="post-tag no-text-decoration" >Malware</a> <a href="/tags/research/" class="post-tag no-text-decoration" >Research</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author. <br>If you find any errors, please let me know by comment or email. Thank you.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=ELF%20header%20%EC%97%90%20%EB%8C%80%ED%95%9C%20%EA%B3%A0%EC%B0%B0%20-%20Unforgettable&url=https%3A%2F%2Fruffalolavoisier.github.io%2Fposts%2Felf_header_analysis%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=ELF%20header%20%EC%97%90%20%EB%8C%80%ED%95%9C%20%EA%B3%A0%EC%B0%B0%20-%20Unforgettable&u=https%3A%2F%2Fruffalolavoisier.github.io%2Fposts%2Felf_header_analysis%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fruffalolavoisier.github.io%2Fposts%2Felf_header_analysis%2F&text=ELF%20header%20%EC%97%90%20%EB%8C%80%ED%95%9C%20%EA%B3%A0%EC%B0%B0%20-%20Unforgettable" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/anti_unzip_on_assets_directory/">The Hidden Originals – Why doesn’t unzip work?</a><li class="text-truncate lh-lg"> <a href="/posts/malware_analysis_conference_review/">2025 년 Malware Conference 회고 및 사용 기술 리뷰</a><li class="text-truncate lh-lg"> <a href="/posts/android_reverse_note_2nd/">The Hidden Originals - How To Load Application From Encrypt Binary</a><li class="text-truncate lh-lg"> <a href="/posts/interview-review/">인터뷰 리뷰 및 회고</a><li class="text-truncate lh-lg"> <a href="/posts/android_reverse_note/">The Hidden Originals - How Protection Layers Conceal Apps</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/android/">Android</a> <a class="post-tag btn btn-outline-primary" href="/tags/research/">Research</a> <a class="post-tag btn btn-outline-primary" href="/tags/develop/">Develop</a> <a class="post-tag btn btn-outline-primary" href="/tags/malware/">Malware</a> <a class="post-tag btn btn-outline-primary" href="/tags/git/">Git</a> <a class="post-tag btn btn-outline-primary" href="/tags/blog/">Blog</a> <a class="post-tag btn btn-outline-primary" href="/tags/reverse/">Reverse</a> <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a> <a class="post-tag btn btn-outline-primary" href="/tags/mobile/">Mobile</a> <a class="post-tag btn btn-outline-primary" href="/tags/software-developer/">Software developer</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/android_license_validator/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1745390703" data-df="ll" > Apr 23, 2025 </time><h4 class="pt-0 my-2"><b>ELF 실행파일에 대한 고찰 - shell</b></h4><div class="text-muted"><p>Android License Validator</p></div></div></a></article><article class="col"> <a href="/posts/detect-screencapture/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1708095600" data-df="ll" > Feb 17, 2024 </time><h4 class="pt-0 my-2"><b>사용자의 행동을 감시하는 코드 - screen capture</b></h4><div class="text-muted"><p>Step by step 최근에 특이한 코드가 눈에 보여 따라가다가 굉장히 재밌는 패턴을 발견하여 해당 코드에 대해 정리해보려고 한다. 사용자의 파일과 액티비티 전환에 따른 결과를 보고 해당 파일을 특정 서버로 전송하는 코드이다. 코드 분석 근래 파일 관찰자와 액티비티 화면 전환을 통하여 최근 디바이스에서 캡쳐한 사진을 확인하는 코드가 발견되었다...</p></div></div></a></article><article class="col"> <a href="/posts/malware_analysis_a_encrypted_string/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1743533997" data-df="ll" > Apr 2, 2025 </time><h4 class="pt-0 my-2"><b>동적으로 로드되는 실행 파일에 대한 고찰 - 3</b></h4><div class="text-muted"><p>malware analysis a encrypted string</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/android_license_validator/" class="btn btn-outline-primary" aria-label="Older" ><p><b>ELF 실행파일에 대한 고찰 - shell</b></p></a> <a href="/posts/bypass_rasp/" class="btn btn-outline-primary" aria-label="Newer" ><p><b>RASP 에 대한 고찰</b></p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2026</time> <a href="https://github.com/RuffaloLavoisier">Ruffalo</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p><div class='typing'>I'm <STRONG><span class="text"></span></STRONG></div><script> document.addEventListener("DOMContentLoaded", function () { const $text = document.querySelector(".typing .text"); const letters = [ "Developer", "Author", "Creator", "Inventor", "Conductor", "Traveler" ]; const speed = 100; let i = 0; const typing = async () => { const letter = letters[i].split(""); while (letter.length) { await wait(speed); $text.innerHTML += letter.shift(); } await wait(800); remove(); }; const remove = async () => { const letter = letters[i].split(""); while (letter.length) { await wait(speed); letter.pop(); $text.innerHTML = letter.join(""); } i = !letters[i + 1] ? 0 : i + 1; typing(); }; function wait(ms) { return new Promise(res => setTimeout(res, ms)) } setTimeout(typing, 1500); }); </script></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.3.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/android/">Android</a> <a class="post-tag btn btn-outline-primary" href="/tags/research/">Research</a> <a class="post-tag btn btn-outline-primary" href="/tags/develop/">Develop</a> <a class="post-tag btn btn-outline-primary" href="/tags/malware/">Malware</a> <a class="post-tag btn btn-outline-primary" href="/tags/git/">Git</a> <a class="post-tag btn btn-outline-primary" href="/tags/blog/">Blog</a> <a class="post-tag btn btn-outline-primary" href="/tags/reverse/">Reverse</a> <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a> <a class="post-tag btn btn-outline-primary" href="/tags/mobile/">Mobile</a> <a class="post-tag btn btn-outline-primary" href="/tags/software-developer/">Software developer</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><script> (function () { const origin = 'https://utteranc.es'; const themeMapper = Theme.getThemeMapper('github-light', 'github-dark'); const initTheme = themeMapper[Theme.visualState]; let script = document.createElement('script'); script.src = 'https://utteranc.es/client.js'; script.setAttribute('repo', 'RuffaloLavoisier/ruffalolavoisier.github.io'); script.setAttribute('issue-term', 'pathname'); script.setAttribute('theme', initTheme); script.crossOrigin = 'anonymous'; script.async = true; const $footer = document.querySelector('footer'); $footer.insertAdjacentElement('beforebegin', script); addEventListener('message', (event) => { let newTheme;if (event.source === window && event.data && event.data.id === Theme.ID) { newTheme = themeMapper[Theme.visualState]; const message = { type: 'set-theme', theme: newTheme }; const utterances = document.querySelector('.utterances-frame').contentWindow; utterances.postMessage(message, origin); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
